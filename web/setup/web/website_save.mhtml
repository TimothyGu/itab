<%args>
	$account
	$tourn
	$news_id => undef
	$title => undef
	$text => undef
	$active => undef
	$news_type => undef
</%args>
<%init>

	my $news;
	my $now;

	if ($news_id) { 

		$news = Tab::News->retrieve($news_id);

	} else { 

		$news = Tab::News->create({
			tournament => $tourn->id,
			posted => $now
		});

	}

	$news->title($title);
	$news->title($news_type) if $news_type;

	$news->active($active);

	$news->text($text);

	$news->edited_by($account->id);
	$news->edited_on($now);

	$news->special($news_type) unless $news_type eq "add";

	$news->update;

	my $msg = "The page ".$title." has been saved";

	$m->redirect("/setup/web/website.mhtml?news_id=".$news->id."&msg=$msg") unless $news_type;
	$m->redirect("/setup/web/website.mhtml?news_type=".$news_type."&msg=$msg");


</%init>

