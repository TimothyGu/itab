<%args>
	$tourn
	$account
	$session
	$news_id => undef
	$news_type => undef
</%args>
<%init>

	my $news = Tab::News->retrieve($news_id) if $news_id;

	unless ($news_type eq "add")  { 
		my @newses = Tab::News->search( tournament => $tourn->id, special => $news_type ) if $news_type;
		$news = shift @newses if @newses;
		$news_id = $news->id if $news;
	}

	my $switch;

</%init>

	<div class="left huge">

%		if ($news || $news_type) { 

			<h2><% ($news) ? "Edit ".$news->title : ucfirst($news_type)." Page" %></h2>

			<form action="website_save.mhtml" method="post">
			<input type="hidden" name="news_id" value="<% $news_id %>">

			<table cellpadding="5" cellspacing="1" width="100%">

%				unless ($news_type && $news_type ne "add") { 

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

						<td>
							Title:
						</td>

						<td>
							<input type="text" name="title" size="50" value="<% ($news) ? $news->title : "" %>">
						</td>


					</tr>

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

						<td>
							Published:
						</td>

						<td>
							<input type="radio" name="active" value="1" <% ($news && $news->active > 0) ? "selected" : ""%>>Yes
							<input type="radio" name="active" value="0" <% ($news && $news->active < 1) ? "selected" : ""%>>No

						</td>

					</tr>

%				}  else {
		
					<input type="hidden" name="news_type" value="<% $news_type %>">

%				}

				<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

					<td colspan="2">
						Page Text:
					</td>
				</tr>

				<tr>
					<td colspan="2" class="center">
						<textarea name="text" rows="15" cols="55"><% ($news) ? $news->text : "" %></textarea>
					</td>

				</tr>

				<tr class="liblrow">

					<td colspan="2" align="right">
						<input type="submit" value="Save Page Text">
						</form>
					</td>

				</tr>

			</table>

%		} else { 

			<h2>Your Tournament Website</h2>

			<p>You can post materials publicly here for inclusion on the
			website that appears when people click on your tournament off the
			tabroom.com main website.</p>

			<p>Your tournament website will always include a listing of the
			events you offer, a listing of the registration deadlines and
			tournament dates, and a link on registering for your tournament.
			Tabroom.com also includes automatic posting of field reports, 
			schematics, and results.
			</p>

			<p>
			The link for your public tournament website is:
			</p>

			<p class="center">

				<a href="<% $Tab::url_prefix %>/index.mhtml?tourn_id=<% $tourn->id %>">
					<% $Tab::url_prefix %>/index.mhtml?tourn_id=<% $tourn->id %>
				</a>

%		}

%		if ($news_type && $news_type eq "main") { 

			<h3>Note about the Main page</h3>

				<p>This text will be the first thing anyone sees when they
				click on your tournament website.  A welcome letter, a
				tournament invitation, and other critical details are
				appropriate for this page.<p>

				<p>If you want to break up your tournament information and
				invitation under multiple tab headers, simply click on Add
				Another Page at right; you can create other pages that will
				appear as separate tabs on the tournament website.</p>

				<p>Please do not make the titles of these pages too long;
				otherwise the tabbed interface will look all weird and stuff.
				</p>
%		}

%		if ($news_type && $news_type eq "postings") { 

			<h3>Note about the Postings page</h3>

			<p>This text will appear next to a side menu which contains all the
			postings & schematics you have chosen to make public, when users
			first click on the Postings tab of the tournament.  </p>

			<p>You can use it to make tournament announcements important to
			the initial stages of the tournament, or messages prior to when
			elimination rounds are announced.</p>

%		}

%		if ($news_type && $news_type eq "events") { 

			<h3>Note about the Events page</h3>

			<p>This text will appear next to a side menu which contains links
			to the descriptions of the events at your tournament, when people
			first click on the Events tab of the tournament website.  </p>

%		}

%		if ($news_type && $news_type eq "fields") { 

			<h3>Note about the Field Reports page</h3>

			<p>This text will appear next to a side menu which contains links
			to the field reports of the events at your tournament which you
			have chosen to publish.</p>

			<p>Field reports will publish the names, schools, and states of
			the students entered in a given event.  It will not publish the
			names of students on waitlists, or students who have been dropped.
			Field reports will not show up anymore after a tournament has
			concluded.</p>

%		}

	</div>

	<& sidebar.mas, tourn => $tourn, news_id => $news_id, $news_type => $news_type &>

	<br style="clear: both;">

