<%args>
	$email
	$account
	$circuit
	$tourn
	$contact => 0
	$entry_only => 0
	$no_setup => 0
</%args>
<%init>

	my $msg;

	if ($email) { 

		my @staff = Tab::Account->search( email => $email );

		unless (@staff) { 
			my $err = "That email address you tried to add doesn't have a corresponding account.  Please try again";
			$m->redirect("access.mhtml?err=$err");
		}

		my $already  = Tab::TournAdmin->search(  account => $staff[0]->id, tourn => $tourn->id )->first;

		unless ($already) { 

			my $access = Tab::TournAdmin->create({
				account    => $staff[0]->id,
				tourn      => $tourn->id,
				contact    => $contact,
				entry_only => $entry_only,
				no_setup   => $no_setup
			});

			$msg = $staff[0]->first." ".$staff[0]->last." has been added to your tournament staff";
		}

	}

	$m->comp("/funclib/update_calendar.mas", tourn => $tourn);
	$m->redirect("access.mhtml?msg=$msg");

</%init>

