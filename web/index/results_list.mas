<%args>
	$tourn_id => undef
</%args>
<%init>

	my $now = DateTime->now;

	Tab::Tourn->set_sql(by_results_published => "
		select distinct tourn.*
		from tourn,tourn_setting
		where tourn.id = tourn_setting.tourn
		and tourn_setting.tag = \"results\"
		and tourn_setting.value = 1
		and tourn.hidden != 1
		and tourn.approved = 1
		order by tourn.start
		limit 55
	");

	my @published = Tab::Tourn->search_by_results_published;

</%init>

		<h3>Results</h3>

%		my $switch;
%		my $notfirst;

%		my $date = $now->clone;

		<ul class="datelist">

%		my $count;

%		foreach my $tourn (sort {$b->start->epoch <=> $a->start->epoch} @published) { 

%			next if $tourn->start > $now;

			<li class="results">

				<table cellpadding="0" cellspacing="0" width="100%">

					<tr>

						<td width="22%" style="padding-right: 4px;">
							<% Tab::niceshortdate($tourn->start) %>
						</td>

						<td style="padding-left: 1px;">
							<a class="tourn" href="/public_site/results/<% $tourn->id %>/index.mhtml">
								<% substr($tourn->name,0,24) %>
							</a>
						</td>
					</tr>

				</table>

			</li>

%		}

