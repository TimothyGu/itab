<%args>
	$tourn
	$err => undef
	$which_rooms
</%args>

<%init>

	my @panels;

	if ($which_rooms eq "all") 

	{ 
		@panels = Tab::Panel->search( tournament => $tourn->id, {order_by => "event,letter"});

	}

	if ($which_rooms eq "prelims") { 
		@panels = Tab::Panel->search( tournament => $tourn->id, type=> "prelim", {order_by => "event,letter"});
	} 

	if ($which_rooms ne "prelims" && $which_rooms ne "all") { 
		my $ts = Tab::Timeslot->retrieve($which_rooms); 

		my @all_panels = Tab::Panel->search( tournament => $tourn->id, {order_by => "event, letter"});
	
		foreach my $ap (@all_panels) { 

			push (@panels, $ap) if $ap->round->timeslot->id == $which_rooms;
		
		}
	}

	$m->flush_buffer;	

	$m->print("<table cellpadding=\"3\">\n");

	PANEL:
	foreach my $panel (@panels) { 
		
		$m->flush_buffer;	

		my $event = $panel->event;
		my $round = $panel->round;

		$m->print("<tr><td>Panel". $event->abbr."  ".$panel->letter." ".$round->name."</td><td> Rooms ");

		foreach my $cr ($panel->round->rooms) { 
		
			$m->print($cr->name);

		}		

		$m->print("</td></tr>\n");

	}

</%init>

</table>
