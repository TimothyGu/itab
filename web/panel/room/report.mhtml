<%args>
	$room_id     => undef
	$timeslot_id => undef
	$tourn
</%args>
<%init>

	my $room = Tab::Room->retrieve($room_id) if $room_id;

	my @panels = $m->comp("/funclib/room_panels.mas", room => $room, tourn => $tourn) if $room;
#	my @pools = $m->comp("/funclib/room_pools.mas", room => $room, tourn => $tourn) if $room;
#	my @strikes = $m->comp("/funclib/room_strikes.mas", room => $room, tourn => $tourn) if $room;

	my $timeslot = Tab::Timeslot->retrieve($timeslot_id) if $timeslot_id;

</%init>


	<& menu.mas, tourn => $tourn, timeslot => $timeslot &>

	<div class="left huge">

		<h2>Rooms</h2>

		<& tabbar.mas, tourn => $tourn, timeslot => $timeslot,  whoami => "room" &>

%		if ($room) { 

%			my $switch;

			<h4>Room <% $room->name %></h4>

			<div class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>">
				<span class="third">
					Site: <% $room->site->name %>
				</span>

				<span class="third">
					Quality: <% $room->quality %>
				</span>

				<span class="third">
					Capacity: <% $room->capacity %>
				</span>
			</div>


			<h4>Rounds scheduled:</h4>

%			foreach my $panel (@panels) { 
			
				<div class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>">

					<span class="quarter">
						<a class="white padleft" href="/panel/schemat/show.mhtml?round_id=<% $panel->round->id %>">
							<% $panel->round->realname %> 
							<% $panel->round->flighted > 1 ? "Flt ".$panel->flight : "" %>
						</a>
					</span>

					<span class="quarter">
						<a class="white padleft" href="/panel/schemat/panel_view.mhtml?panel_id=<% $panel->id %>">
							<% $panel->round->event->abbr %> Sec <% $panel->letter %>
						</a>
					</span>

					<span class="half">

						<span class="quarter">
							<% $panel->round->timeslot->name %>
						</span>

						<span class="threequarter">
							<% Tab::niceshortdayt($panel->round->timeslot->start) %> - 
							<% Tab::niceshortdayt($panel->round->timeslot->end) %>
						</span>

					</span>


				</div>

%			}


%		}

	</div>


