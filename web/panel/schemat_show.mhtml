<%args>
	$circuit
	$tourn
	$show => undef
	$event_id => undef
	$round_id => undef
</%args>
<%init>

	my $event = Tab::Event->retrieve($event_id) if $event_id;
	my $round = Tab::Round->retrieve($round_id) if $round_id;

	unless ($event || $round) { 
		my $msg = "Please pick an event or a round plz";
		$m->redirect("/register/index.mhtml?msg=$msg");
	}

	$event = $round->event unless $event;

	my @rounds = sort {$a->name <=> $b->name} $event->rounds;

</%init>

%	if (@rounds) { 

%		$round = $rounds[0] unless $round;

%	} else {


		<h2> No rounds scheduled of <% $event->name %></h2>

		<a href="/setup/schedule/event.mhtml?event_id=<% $event_id %>">Schedule Some</a>

%		$m->abort;

%	}

	<h2><% $event->name %></h2>

	<ul id="tabnav">

%		foreach my $allround (@rounds) {

%			if ($allround->unbalanced) { 

				<li class="warning"> 

%			} else { 
				
				<li class="<% ($allround->id == $round->id) ? "selected" : "" %>">
%			}

				<a href="schemat_show.mhtml?round_id=<% $allround->id %>"> 
					<% ($allround->label) ? $allround->label : "Rnd ".$allround->name %>
				</a>
			</li>
%		}

	</ul>

%	if ($round && $round->preset < 1) { 

%	 	if ( $event->type eq "speech" ) { 
			<& schemats/speech_schemat.mas, round => $round, show => $show &>
%		}

%	 	if ( $event->type eq "congress" ) { 
			<& schemats/congress_schemat.mas, round => $round &>
%		}

% 		if ( $event->type eq "debate" ) { 

			<& schemats/debate_schemat.mas, round => $round &>

%		}

%	}


%	if ($round->preset) { 
	
		<& preset_edit.mas, round => $round &>

%	} 	

