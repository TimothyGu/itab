<%args>
	$tourn
	$round_id => undef
</%args>
<%init>

	my $round = Tab::Round->retrieve($round_id) if $round_id;
	my $event = $round->event;

	unless ($round) { 
		my $msg = "Pick a round plz";
		$m->redirect("/register/index.mhtml?msg=$msg");
	}

	my $preset = 1 unless $m->comp('/funclib/round_entries.mas', round => $round);

	if ( $event->type eq "speech" ) { 
		$m->comp("blast_speech.mas", round => $round);
	}

	if ( $event->type eq "congress" ) { 
		$m->comp("blast_congress.mas", round => $round);
	}

 	if ( $event->type eq "debate" || $event->type eq "policy" || $event->type eq "ld") { 
		$m->comp("blast_debate.mas", round => $round);
	}

	my $tz = $tourn->tz;
	$tz = "UTC" unless $tz;
	my $now = DateTime->now( time_zone => $tz);

	$round->blasted($now);
	$round->update;

	my $msg = "Email and text notices sent for round 1";
	$m->redirect("show.mhtml?round_id=".$round->id."&msg=$msg");

</%init>
