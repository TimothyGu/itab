<%args>
	$round_id
	$entry_id
	$number => undef
</%args>
<%init>

	my $round = Tab::Round->retrieve($round_id);
	my $event = $round->event;

	my @existing = $round->panels;

	@existing = sort {$b->letter <=> $a->letter} @existing;
	@existing = sort {$b->letter cmp $a->letter} @existing if $event->setting("panel_labels") eq "letters";

	my $last = shift @existing;

	my $letter = $last->letter;

	foreach (1 .. $number) { 

		if ($letter eq "Z") { 
			$letter = "AA";
		} elsif ($letter eq "AZ") { 
			$letter = "BA";
		} elsif ($letter eq "BZ") {
			$letter = "CA";
		} elsif ($letter eq "CZ") {
			$letter = "DA";
		} elsif ($letter eq "DZ") {
			$letter = "EA";
		} elsif ($letter eq "EZ") {
			$letter = "FA";
		} else { 
			$letter++;
		}   

        my $panel = Tab::Panel->create({
            round => $round->id,
            letter => $letter
        }); 

	}

	$m->redirect("wudc_round_edit.mhtml?round_id=$round_id&entry_id=$entry_id");

</%init>


