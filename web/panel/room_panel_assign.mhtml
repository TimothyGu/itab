<%args> 
	$tourn
	$account
	$event_id 
	$panel_letter => undef
</%args>

<%init>
	my $event = Tab::Event->retrieve($event_id) if $event_id;

</%init>

<h3>Pick rooms for <% $event->name %></h3>

<form action="panel_save_many_rooms.mas" method="post">
<input type="hidden" name="panel_letter" value="<% $panel_letter %>">
<input type="hidden" name="event_id" value="<% $event_id %>">
<table cellpadding="5" width="75%" >

<tr>

<td align="center"><b>Panel</td>

% foreach my $round (sort {$a->name <=> $b->name} $event->rounds) {

	<td align="center"><b><% ($round->label) ? $round->label : $round->name %></td>

%}

</tr>

<%perl> 

foreach my $letter ($event->letters) { 

	my $letter = $letter->letter;

	my @panels = Tab::Panel->search( letter => $letter, event => $event->id );

	@panels = sort {$a->round->name <=> $b->round->name} @panels;

</%perl>


<tr>
	<td align="center"> <% $letter %></td>

<%perl>

foreach my $panel (@panels) { 

	my $already_room = $panel->room;
	my $already_id;

	$already_id = $already_room->id	if ($already_room);

	my $event = $panel->event;
	my $round = $panel->round;

</%perl>


<td align="center"><select name="room_id_<% $panel->id %>">

%	if ($already_id) {
		<option value="<% $already_id %>" selected><% $panel->room->name %></option>
% }

% foreach my $cr (sort {$a->name cmp $b->name} $panel->round->rooms) { 

	<option value="<% $cr->id %>" >
	<% $cr->name %>
	</option>
% }
</select>
</td>

% }

</tr>

% }

<td align="center" colspan="4"><input  type="submit" value="Save Room"></td>
</tr>
<table>
