<%args>
	$account
	$panel_id
	$tourn
	$comp_id
	$certain => undef
	$from => undef
</%args>
<%init>

	my $panel = Tab::Panel->retrieve($panel_id);
	my $event = $panel->round->event;
	my $comp = Tab::Entry->retrieve($comp_id);

	if ( ($certain eq "I am certain")) {


		if ($event->type eq "congress" ) {

			#Remove from all prelim chambers of this name.

			my @chambers = Tab::Panel->search( 
						event => $event->id, 
						letter => $panel->letter);

			foreach my $chamber (@chambers) { 
				foreach my $ballot (Tab::Ballot->search(
							comp => $comp->id, 
							panel => $chamber->id)) { 
					$ballot->delete;
				}
			}

		} else {

			foreach my $ballot (Tab::Ballot->search(
					comp => $comp->id, 
					panel => $panel->id)) { 
				$ballot->delete;
			}
		}

		$m->redirect("$Tab::url_prefix/panel/manual_assign.mhtml?panel_id=".$panel->id) if $from eq "manual";
		$m->redirect("$Tab::url_prefix/panel/schemat_show.mhtml?event_id=".$event->id);
	}

</%init>

<&  "/funclib/warning.mas", account => $account &>

<h3></h3>
<p></p>
<br><br>
<br><br>
<center>
<P><B>

	You are about to remove competitor <% $comp->code %> from round
	<% $panel->round->name %> section <% $panel->letter %>.

	<p>This cannot be undone.  You can only get it back
	by re-entering the kid manually into the round</p>

	<p>Don't say I didn't warn you.</p>

% if ($certain) {

<p><font color="red">You did not type "I am certain", exactly like that.  Try
again</font></p>

% }

<br><br>
<p>To proceed, type "I am certain" in the box below:</p>
<br><br>
<form action="comp_rm_from_panel.mhtml" method="post">

<input type="hidden" value="<% $panel_id %>" name="panel_id">
<input type="hidden" value="<% $comp_id %>" name="comp_id">
<p align="center">
<input type="text" name="certain" size="20"></p>
<p align="center">
<input  type="submit" value="Drop Kid From Panel"></p>
</center>
</form>
