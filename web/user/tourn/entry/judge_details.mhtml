<%args>
	$judge_id
	$school_id
</%args>
<%init>

	my $judge = Tab::Judge->retrieve($judge_id);
	my $school = Tab::School->retrieve($school_id);
	my $group = $judge->judge_group;
	my $tourn = $group->tournament;

	my $switch;

</%init>

	<div class="left huge"> 

		<h2>Additional details needed</h2> 

		<form action="judge_details_save.mhtml" method="post">
		<input type="hidden" name="judge_id" value="<% $judge->id %>">
		<input type="hidden" name="school_id" value="<% $school->id %>">

%	if ($tourn->method->judge_cells) { 

		<h3>Judge contact information</h3>

		<table cellpadding="5" cellspacing="1" width="97%" align="right">

			<tr class="evenrow">

				<td>
					Cell Phone Number
				</td>

				<td>
					<input type="text" size="30" name="cellphone" value="<% $judge->cell %>">
				</td>

			</tr>

		</table>

%	}

%	if ($group->coach_ratings) { 

		<h3>Rate this judge</h3>

		<table cellpadding="3" cellspacing="1" width="97%" align="right">

%		if ($group->qual_subsets) { 

%			foreach my $subset ($group->qual_subsets) { 

%				my $rating = $judge->rating($subset);

				<tr>

					<td colspan="3">

						<h4>
							<% $subset->name %> 

							<span style="text-align: right; font-size: 80%; font-style: italic; padding-left: 25px;">
%								my $notfirst;
%								foreach my $event ($subset->events) { 
									<% ($notfirst) ? ", " : "" %>
									<% $event->name %>
%									$notfirst++;
%								}
							</span>
						</h4>

					</td>

				</tr>

%				foreach my $qual (sort {$a->name cmp $b->name} $group->quals(type => "qual")) {

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>> 

						<td align="center">
							<input type="radio" name="<% $subset %>" value="<% $qual->id %>" id="<% $subset->id."-".$qual->id %>" 
								<% ($rating && $rating->qual->id == $qual->id) ? "checked" : "" %>>
						</td>

						<td align="center">
							<label for="<% $subset->id."-".$qual->id %>">
								<% $qual->name %>
							</label>
						</td>

						<td>
							<label for="<% $subset->id."-".$qual->id %>">
								<% $qual->description %>
							</label>
						</td>

					</tr>

%				} 

%			}

%		} else { 

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>> 
				
				<td align="right">

%				my $rating = $judge->rating;

%					foreach my $qual (sort {$a->name cmp $b->name} $group->quals(type => "qual")) {

						<span class="spacey">

							<input type="radio" name="qual_id" value="<% $qual->id %>" id="<% $qual->id %>"
								<% ($rating && $rating->qual && $rating->qual->id == $qual->id) ? "checked" : "" %>>

							<label for="<% $qual->id %>">
								<% $qual->name %>
								<% $qual->description %>
							</label>

						</span>

%					} 

				</td> 
				
			</tr>

%		}

			</table>
			
%	}

%	if ($group->ask_alts) { 
	
		<table cellpadding="5" cellspacing="1" width="97%" align="right">

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>> 
				
				<td>
					Also judges group:
				</td> 
				
				<td>
					<select name="alt_id">
					
						<option value="">
							None Selected
						</option>

%						foreach my $ogroup (sort {$a->name cmp $b->name} $tourn->groups) { 

%						   next if $group->id == $ogroup->id;
%						   next if $group->tab_room;

							<option value="<% $ogroup->id %>" <% ($ogroup->id eq $judge->alt_group->id) ? 'selected' : '' %> >
								<% $ogroup->name %>
							</option>
%					   }

					</select>

				</td>

			</tr>

		</table>

%	}

%	if ( $group->ask_paradigm ) { 

		<h3>Judging paradigm</h3>

		<table cellpadding="5" cellspacing="1" width="97%" align="right">

			<tr>
				<td>
					<% $group->paradigm_explain %>
				</td>
			</tr>

			<tr>
				<td align="center">
					<textarea name="paradigm" rows="5" cols="55"><% $judge->paradigm %></textarea>
				</td>
			</tr>

		</table>

%	}

	<table width="100%">
			
		<tr class="liblrow">

			<td align="right">
				<input type="submit" value="  Save Details   ">
				</form>
			</td>

		</tr>

	</table>
			
</div>

<div id="rightsmall">
		
	<h3>Judge</h3>

	<p style="text-align: right;">
		<% $judge->first." ".$judge->last %>
	<br />
		<% $judge->judge_group->name %>
	</p>

</div>

