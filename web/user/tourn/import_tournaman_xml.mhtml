<%args>
	$tourn
        $account
        $session
</%args>

<%init>
#Import the XML
	use XML::Simple;

	my $now = DateTime->now;
	my $tz = $account->tz if $account->tz;
	$tz = "UTC" unless $tz;

	$now->set_time_zone($tz);

	my $req = Apache2::Request->new($r);
	my $xml_file = $req->upload("xml");
	my $xml_filename = $xml_file->tempname;

	print "xml_filename=".$xml_filename."<Br>";
	print "$xml_file->filename = ".$xml_file->filename."<br>";

	my $webname=$xml_file->filename;

	`/bin/cp $xml_filename /tmp/keeper.xml`;
	`perl -pi -e s/'&'/'&amp;'/g  $xml_filename`;

#	my $xml = new XML::Simple ( SuppressEmpty => 1,  ForceArray => [ qw(team) ]);
	my $xml = new XML::Simple();
	my $data = $xml->XMLin($xml_filename, KeyAttr => "round");

#	print "Name:".$data->{team}->{9}->{name}."<br>";
#	print "pullups:".$data->{team}->{9}->{pullups}."<br>";
#	print "home:".$data->{team}->{9}->{home}."<br>";
#	print "ident:".$data->{team}->{9}->{ident}."<br>";

	print "scalar output for the array =".$data->{team}."<br>";

#	use Data::Dumper;
#	print Dumper( $data );

	#	Show tourn values
	my $dummy;

	my @teams;
	my %team_hash = ();

	eval { 
		@teams = @{$data->{team}};
	};

	push @teams, $data->{team} unless @teams;

	foreach my $team (@teams) { 
		$m->print($team->{name}."<Br>");
	}


	print "<br>Done";
	
</%init>
