<%args>
	$judge_id
	$school_id
</%args>
<%init>

	my $judge = Tab::Judge->retrieve($judge_id);
	my $school = Tab::School->retrieve($school_id);
	my $group = $judge->judge_group;
	my $tourn = $group->tournament;

	my $switch;

</%init>

	<div class="left huge"> 

		<h2>Limit <% $judge->first." ".$judge->last %>'s availability</h2>

		<table cellpadding="5" cellspacing="1" width="100%">

			<tr class="liblrow">
			
				<th>
					Timeblock
				</th>

				<th>
					Fee if under 
				</th>

				<th>
					Availability (click to change)
				</th>

			</tr>

%			foreach my $bin ($group->bins) { 

				<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

					<td>
						<% $bin->name %>
					</td>
	
					<td align="right">
						$<% $bin->fine %>
					</td>

					<td align="center">

%						if ($bin->strike($judge)) { 
		
							<a class="red block" href="bin_flip.mhtml?judge_id=<% $judge->id %>&bin_id=<% $bin->id %>&school_id=<% $school->id %>">
								Unavailable
							</a>

%						} else { 

							<a class="white block" href="bin_flip.mhtml?judge_id=<% $judge->id %>&bin_id=<% $bin->id %>&school_id=<% $school->id %>">
								Available
							</a>

%						}

					</td>

				</tr>

%			}

			<tr class="liblrow">

				<td width="100%" colspan="6" align="right">
					<form action="judges.mhtml" method="post">
					<input type="hidden" name="group_id" value="<% $group->id %>">
					<input type="hidden" name="school_id" value="<% $school->id %>">
					<input type="submit" value="  Save & Return  ">
					</form>
				</td>
			</tr>

		</table>

	</div>


	<div class="right small">

		<a class="blue block" href="judges.mhtml?group_id=<% $group->id %>&school_id=<% $school->id %>">
			Judge: <% $judge->first." ".$judge->last %>
		</a>

		<a class="blue block" href="judges.mhtml?group_id=<% $group->id %>&school_id=<% $school->id %>">
			<% $judge->judge_group->name %>
		</a>

			

	</div>
