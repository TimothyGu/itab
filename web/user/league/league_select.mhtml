<%args>
	$session
	$league_id
	$account
</%args>
<%init>

	# Make sure the user has access to that league through whatever pathway.
	my $league = Tab::League->retrieve($league_id);

	my $ok;

	if ($league) { 

		$ok++ if $account->site_admin;

		$ok++ if grep $_->id eq $league->id, $account->leagues;

		if ($ok) { 

			$session->league($league->id);
			$session->update;
			$m->redirect("$Tab::url_prefix/league/league_view.mhtml");

		}


	} else { 

		$m->print("<p>That league doesn't exist.  Quit messing around with the system.</p>");
		$m->abort;

	}

</%init>
