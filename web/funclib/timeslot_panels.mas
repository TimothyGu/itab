<%args>
	$timeslot
	$event => undef
	$unconfirmed => undef
	$confirmed => undef
</%args>
<%init>

	if ($unconfirmed) { 

		Tab::Panel->set_sql( unconfirmed_by_timeslot => "
			select distinct panel.*
			from panel, round
			where panel.round = round.id
			and round.timeslot = ? 
			and panel.confirmed is null
			order by panel.letter
		");

		return Tab::Panel->search_unconfirmed_by_timeslot($timeslot->id);
		
	} elsif ($confirmed) { 

		Tab::Panel->set_sql( confirmed_by_timeslot => "
			select distinct panel.*
			from panel, round
			where panel.round = round.id
			and round.timeslot = ? 
			and panel.confirmed is not null
			order by panel.letter
		");

		return Tab::Panel->search_confirmed_by_timeslot($timeslot->id);

	} elsif ($event) { 

		Tab::Panel->set_sql( by_timeslot_event => "
			select distinct panel.*
			from panel, round
			where panel.round = round.id
			and round.timeslot = ? 
			and round.event = ? 
			order by panel.letter
		");

		return Tab::Panel->search_by_timeslot_event($timeslot->id, $event->id);


	} else { 

		Tab::Panel->set_sql( by_timeslot => "
			select distinct panel.*
			from panel, round
			where panel.round = round.id
			and round.timeslot = ? 
			order by panel.letter
		");

		return Tab::Panel->search_by_timeslot($timeslot->id);

	}

</%init>

