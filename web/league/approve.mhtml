<%args>
	$tourn_id
	$account
	$league_id => undef
</%args>
<%init>

	my $tourn = Tab::Tournament->retrieve($tourn_id);

	my $league = $tourn->league if $league_id;

	unless ($account->site_admin || (grep $_->id == $league_id, $account->leagues)) {
		$m->print("<h2>Shenanigans!</h2> <p>I call shenanigans.  You do not have permissions to approve that tournament.  Stop trying.</p>");
		$m->abort;
	}

	$tourn->approved(1);
	$tourn->update;

	my $msg = "Tournament ".$tourn->name." has been approved.";

	$m->redirect("/league/approvals.mhtml?league_id=".$league_id."&msg=".$msg) if $league_id;

	$m->redirect("/league/approvals.mhtml?msg=".$msg) if $account->site_admin;

</%init>
