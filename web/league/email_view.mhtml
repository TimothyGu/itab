<%args>
	$league
	$account
	$email_id
</%args>
<%init>

	my $email = Tab::Email->retrieve($email_id);

	my $year = $email->senton->year;
	$year-- if $email->senton->month < 7;

	use Text::Wrap
    $Text::Wrap::columns = 70;

	my $switch;

	my $text = $email->text;

</%init>

	<table width="100%">

		<tr>

			<td width="100%">
				<h2>Email to membership:</h2>
			</td>

			<td>
				<form action="emails.mhtml" method="post"> 
				<input type="hidden" name="year" value="<% $year %>">
				<input class="blue" type="submit" value="Back to archive" align="right">
				</form>
			</td>

		</tr>

	</table>

	<table cellpadding="3" width="60%"> 

		<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
			<th>Subject:</th>
			<td><% $email->subject %></td>
		</tr>

		<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
			<th>Sender:</th>
			<td><% $email->sender->first." ".$email->sender->last %></td>
		</tr>
		
		<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
			<th>Sent to:</th>
			<td><% $email->sent_to %></td>
		</tr>
		
		<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
			<th>Sent on:</th>
			<td><% Tab::nicedt($email->senton->set_time_zone($league->timezone)) %></td>
		</tr>
		
		<tr>
			<th colspan="2">
				<h4>Text of message:</h4>
			</th>
		</tr>

		<tr>
			<td colspan="2">
				<pre>
		   			<%	print wrap('', '', $text) %>
				</pre>
			</td>
		</tr>
	</table>
