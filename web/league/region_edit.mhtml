<%args> 
	$region_id => undef
	$league
	$account
</%args>
<%init>

	my $region = Tab::Region->retrieve($region_id) if $region_id;
	my $switch;

</%init>

	<h2><% ($region) ? $region->name : "" %></h2>
	
	<table cellpadding="5" cellspacing="1" width="100%">

		<form action="region_save.mhtml" method="post"> 
		<input type="hidden" name="region_id" value="<% $region_id %>">

		<tr class="oddrow">
			<td>
				Name:
			</td>

			<td>
				<input type="text" name="name" value="<% ($region) ? $region->name : "" %>" size="30">
			</td>

		</tr>

		<tr class="evenrow">

			<td>
				Code:
			</td>

			<td>
				<input type="text" name="code" value="<% ($region) ? $region->code : "" %>" size="5">
			</td>
		</tr>

%		if ($league->diocese_based) {

			<tr class="oddrow">

				<td>
					Quota
				</td>
	
				<td>
					<input type="text" name="quota" value="<% ($region) ? $region->quota : "" %>" size="5">
				</td>

			</tr>

			<tr class="evenrow">

				<td>
					Archdiocese?
				</td>
	
				<td>
					<input type="checkbox" name="arch" value="1" <% ($region && $region->arch) ? "checked" : "" %>>
				</td>

			</tr>

%		}


		<tr class="oddrow">

			<td>
				Director:
			</td>
			
			<td>
				<input type="text" name="director_email" size="30" 
				value="<% ($region) ? ($region->director) ? $region->director->email : "" : "" %>">
			</td>

		</tr>

		<tr class="liblrow">
			<td colspan="2" class="right">
				<input class="blue" type="submit" value="Save Region">
				</form>
			</td>
		</tr>

	</table>

% if ($region) {

	<h4><% $region->name %>'s chapters</h4>

%	undef $switch;

	<table cellpadding="5" width="100%">

% 		foreach my $chapter (sort {$a->name cmp $b->name} $region->chapters($league)) { 

			<tr <% ($switch++ % 2) ? "class=\"evenrow\"" : "class=\"oddrow\"" %>>

				<td>
					<a href="/league/chapter_edit.mhtml?chapter_id=<% $chapter->id %>">
					<% $chapter->name %>
					</a>
				</td>

				<td>
					<% $chapter->code($league) %>
				</td>

			</tr>
% 		}	

	</table>

% 	}
