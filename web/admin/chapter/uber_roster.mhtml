<%args>
	$account
	$chapter_id
	$show_retired => undef
	$err => undef
	$sort_by => "last"
	$from => undef
</%args>
<%init>

	my $chapter = Tab::Chapter->retrieve($chapter_id);

	my @ubers;
 
	if ($show_retired) { 

		@ubers = $chapter->ubers;

	} else {

		@ubers = $chapter->ubers( retired => 0 );

	}

	@ubers = sort {$a->last cmp $b->last} @ubers;

	@ubers = sort {$b->started <=> $a->started } @ubers if $sort_by eq "started";

	@ubers = sort {$b->retired <=> $a->retired } @ubers if $sort_by eq "retired";

	my $message;

</%init>

	<div class="left huge">

		<table cellpadding="0" width="100%">
	
			<tr>
				<td width="100%">
					<h2><% $chapter->name %> Judge Roster</h2>
				</td>

				<td>
					<form action="chapter_edit.mhtml" method="post">
					<input type="hidden" name="chapter_id" value="<% $chapter_id %>">
					<input type="submit" value=" Back ">
					</form>
				</td>

			</tr>

		</table>

		<table width="100%" cellpadding="4" cellspacing="1">

			<tr class="liblrow">

				<th>
					<a href="uber_roster.mhtml?chapter_id=<% $chapter_id %>&show_retired=<% $show_retired %>&sort_by=last"> Name </a>
				</th>

				<th>
					<a href="uber_roster.mhtml?chapter_id=<% $chapter_id %>&show_retired=<% $show_retired %>&sort_by=cell">Cell</a>
				</th>

				<th>
					<a href="uber_roster.mhtml?chapter_id=<% $chapter_id %>&show_retired=<% $show_retired %>&sort_by=started">Started</a>
				</th>

%				if ($show_retired) { 

					<th>
						<a href="uber_roster.mhtml?chapter_id=<% $chapter_id %>&show_retired=<% $show_retired %>&sort_by=retired">Inactive</a>
					</th>

%				}

				<th class="right" colspan="2">

					<form action="uber_roster.mhtml" method="post">
					<input type="hidden" name="chapter_id" value="<% $chapter_id %>">

%  					if ($show_retired) {
						<input class="grey" type="submit" value="Hide Inactives" align="right">
%					} else {
						<input type="hidden" name="show_retired" value="boomshika">
						<input class="grey" type="submit" value="Show Inactives" align="right">
% 					}

					</form>
						
						
				</th>

			</tr>

% 			my $switch; 

% 			foreach my $uber (@ubers) { 

%				next if $uber->retired &! $show_retired;

				<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

					<td>
						<a id="<% $uber->id %>"></a>
						<% $uber->last.", ".$uber->first %>
					</td>

					<td class="smaller" align="center">
						<% $uber->cell %>
					</td>

					<td class="smaller" align="center">
						<% $uber->started %>
					</td>

%					if ($show_retired) { 
						<td class="center">
							<% ($uber->retired) ? "Y" : "" %>
						</td>
%					}
							
					<td class="right">
						<form action="uber_edit.mhtml" method="post">
						<input type="hidden" name="uber_id" value="<% $uber->id %>">
						<input class="grey" type="submit" value="Edit">
						</form>
					</td>

					<td class="right">
						<form action="uber_retire.mhtml" method="post">
						<input type="hidden" name="uber_id" value="<% $uber->id %>">
						<input class="<% ($uber->retired) ? "red" : "grey" %>" type="submit" 
							value="<% ($uber->retired) ? "Activate" : "  De-activate  " %>">
						</form>
					</td>

				</tr>

% 			}

		</table>

	</div>

	<div class="right small">

%		undef $switch;

		<table width="100%" cellpadding="5" cellspacing="1">

			<tr>
				<td colspan="4">
					<h3>Add new judge</h3>
					<form action="uber_save.mhtml" method="post"> 
					<input type="hidden" name="chapter_id" value="<% $chapter_id %>">
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
				<td>
					First:
				</td>

				<td colspan="3">
					<input type="text" name="first" size="15">
				</td>

			</tr>
	
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					Last:
				</td>

				<td colspan="3">
					<input type="text" name="last" size="15">
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
				<td>
					Started Judging:
				</td>

				<td colspan="3">
					<input type="text" name="started" size="10" value="Enter a year" onfocus='value=""'>
				</td>
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
				<td>
					Gender:
				</td>

				<td>
					<input type="radio" name="gender" value="F">F
				</td>

				<td>
					<input type="radio" name="gender" value="M">M
				</td>
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					Notes:
				</td>

				<td colspan="3">
					<input type="text" name="notes" size="15">
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

				<td>
					Cell Phone:
				</td>

				<td colspan="3">
					<input type="text" name="cell" size="15">
				</td>
			</tr>

			</tr>
			<tr class="liblrow">
				<td align="right" colspan="4">
				<input class="blue" type="submit" value="   Save Judge   ">
				</form>
				</td>
			</tr>

		</table>

	</div>

