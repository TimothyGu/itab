<%args>
	$tourn
</%args>
<%init>

	my @schools = sort {$a->name cmp $b->name} $tourn->schools;
	
	my @empty_schools;
	
	foreach my $school (@schools) { 
		next if $school->entries(dropped => 0);
		push (@empty_schools, $school);
	}

	my $switch;
</%init>

	<& data_menu.mas, whoami => "schools_empty" &>

	<div class="left huge">
					
		<h2><% scalar @empty_schools %> empty schools in <% $tourn->name %></h2>

		<table cellpadding="5" cellspacing="0" width="100%">

%		foreach my $school (@empty_schools) { 

%			my ($fee, $feline_ref) = $m->comp("/funclib/school_fees.mas", school_id => $school->id);

			<tr class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>"> 
			
				<th>
					<a class="white block" href="/register/school/edit.mhtml?school_id=<% $school->id %>">
						<% $school->short_name %>
					</a>
				</th>

				<td>
					<% scalar $school->entries(dropped => 0) %> Entries
				</td>
				
				<td>
					<% scalar $school->entries(dropped => 1) %> Drops
				</td>
				
				<td>
					<% scalar $school->judges(dropped => 0) %> Judges
				</td>

				<td>
					<% scalar $school->judges(dropped => 1) %> Dropped Judges
				</td> 
				
				<td>
					<% ($fee) ? $fee : "0" %> in fees
				</td>

%           	my $warn = "This will delete the entire record of ".$school->short_name." ever entering your tournament, including drop fees etc.  Contine?";

				<td class="centeralign">
					<a class="dkred block" <& "/funclib/confirm.mas", warn => $warn &> href="empty_drop.mhtml?school_id=<% $school->id %>">
						Drop School
					</a>
				</td> 
				
			</tr>

%		} 

	</table>

	</div>
