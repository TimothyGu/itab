<%args>
	$tourn
</%args>
<%init>

	my $switch;

	my @events = sort {$a->name cmp $b->name} $tourn->events;

	my %event_name = ();

	foreach my $event (@events) { 
		$event_name{$event->id} = $event->abbr;
	}

</%init>

	<& "reports_menu.mas", tourn => $tourn, whoami => "multiple_entries" &>

	<div class="left huge"> 
	
		<h2>Double Entered Students</h2>

		<table cellpadding="3" cellspacing="1" width="100%">

			<tr class="yellowrow">

				<th>
					Event
				</th>

				<th>
					Entry
				</th>

				<th>
					Other Entries
				</th>

			</tr>

% 			foreach my $event (@events) { 

%				my ($multi_ref, $other_ref) = $m->comp("/funclib/event_multi_entry.mas", event => $event, all => 1);

%				my @multis = @$multi_ref;
%				my @others = @$other_ref;

%				foreach my $multi (@multis) { 

					<tr class="<% ($switch++ % 2) ? "oddrow" : "evenrow" %>"> 
			
						<td>
							<% $event->abbr %>
						</td>

						<td class="mono rightalign">
							<% $m->comp("/funclib/entry_code.mas", entry => $multi) %>
						</td>

						<td class="mono rightalign">
%							foreach my $other (@others) { 

%								next unless $other->multi == $multi->id;

								<a class="spacey white" href="/register/entry/edit.mhtml?entry_id=<% $other->id %>">
									<% $event_name{$other->event->id} %> <% $m->comp("/funclib/entry_code.mas", entry => $other) %>
								</a>

%							}

						</td>
	
					</tr>

% 				}
% 			}

		</table>

	</div>


