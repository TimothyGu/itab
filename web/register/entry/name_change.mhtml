<%args>
	$id
	$value
</%args>
<%flags>
	inherit => undef
</%flags>
<%init>

	my $err;

	my $entry = Tab::Entry->retrieve($id);


	if ($value && $value ne $entry->name) { 

		my @existing = Tab::Entry->search( name => $value, tourn => $entry->tourn->id );

		if (@existing) { 
	
			my $err = "An entry with name $value already exists.  Names must be unique.";
			$m->print('<script type="text/javascript" language="javascript"> $(document).ready(function() { $.jGrowl("'.$err.'", { header: "Nope", life: 8000, theme: "warning", position: "top-left", sticky: true });}); </script>');

			$m->print($entry->name);
		
		} else { 
	
			$entry->name($value);
			$entry->update;

			my $msg = "Entry name changed to $value";
			$m->print('<script type="text/javascript" language="javascript"> $(document).ready(function() { $.jGrowl("'.$msg.'", { header: "All set", life: 4000  }); }); </script>');
			$m->print($value);
	
		}

	}

	return;

		
</%init>
