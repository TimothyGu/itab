<%args>
	$diocese_1
	$diocese_2
	$tourn
</%args>
<%perl>

	my $diocese1 = Tab::Region->retrieve($diocese_1);
	my $diocese2 = Tab::Region->retrieve($diocese_2);


	foreach my $judge1 ($diocese1->judges($tourn) ) { 

		my @existing = Tab::Strike->search( region => $diocese2->id, judge => $judge1->id );
		next if @existing;

		Tab::Strike->create({
			type => "region",
			tournament => $tourn->id,
			judge => $judge1->id,
			region => $diocese2->id
		});

	}

	
	foreach my $judge2 ($diocese2->judges($tourn) ) { 
		my @existing = Tab::Strike->search( region => $diocese1->id, judge => $judge2->id );
		next if @existing;

		Tab::Strike->create({
			type => "region",
			tournament => $tourn->id,
			judge => $judge2->id,
			region => $diocese1->id
		});

	}

	my $err = $diocese1->name." and ".$diocese2->name." blocked against each other.";

	$m->redirect("$Tab::url_prefix/register/diocese_mutual_blocks.mhtml?err=$err");


</%perl>

