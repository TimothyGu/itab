<%args>
	$tourn
	$circuit
	$session
	$sort_by => "name"
</%args>
<%init>

	my @dioceses = sort {$a->name cmp $b->name} $tourn->regions;

	if ($sort_by eq "code") {
		@dioceses = sort {$a->code cmp $b->code} @dioceses;
        @dioceses = sort {length($a->code) <=> length($b->code)} @dioceses;
	}

	if ($sort_by eq "quota") {
		@dioceses = sort {$b->quota cmp $a->quota} @dioceses;
	}

</%init>

<h3>Dioceses attending <% $tourn->name %></h3>

<table cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="25%" align="center">
	<form action="list.mhtml" method="post">
	<select name="sort_by">
		<option value="name" <% ($sort_by eq "name") ? "selected" : "" %>>Diocese Name</option>
		<option value="code" <% ($sort_by eq "code") ? "selected" : "" %>>Diocese Code</option>
		<option value="quota" <% ($sort_by eq "quota") ? "selected" : "" %>>Entry Quota</option>
	</select>
</td>
<td width="25%">
	<input  type="submit" value="Re-sort">
	</form>
</td>
<td align="right">
	<form action="list_print.mhtml" method="post">
	<input type="hidden" name="sort_by" value="<% $sort_by %>">
	<input  type="submit" value="Print Diocese List">
	</form>
</td>
</tr>
</table>

<hr>

<center>
<table cellpadding="5" cellspacing="1" width="50%">

%	my $switch;

%	foreach my $diocese (@dioceses) { 

	<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

	<td><% $diocese->code %></td>

	<td><% ($diocese->arch) ? "The Archdiocese of " : "The Diocese of " %>
	<% $diocese->name %></td>

	<td><% $diocese->quota %></td>

	<td><% scalar $diocese->schools( tournament => $tourn->id ) %></td>
	
	</tr>

%	}	

</table>
</center>



