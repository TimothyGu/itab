<%args>
	$tourn
	$circuit
	$session
	$sort_by => "name"
</%args>
<%init>

	my @schools = sort {$a->name cmp $b->name} $tourn->schools;

	if ($sort_by eq "id") {
		@schools = sort {$a->chapter->id cmp $b->chapter->id} @schools;
	}

	if ($sort_by eq "diocode") {
		@schools = sort {$a->region->code cmp $b->region->code} @schools;
        @schools = sort {length($a->region->code) <=> length($b->region->code)} @schools;
	}

	if ($sort_by eq "dioname") {
		@schools = sort {$a->region->name cmp $b->region->name} @schools;
	}


</%init>

<h3><% scalar @schools %> Schools attending <% $tourn->name %></h3>

<table cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="25%" align="center">
	<form action="school_report.mhtml" method="post">
	<select name="sort_by">
		<option value="name" <% ($sort_by eq "name") ? "selected" : "" %>>School Name</option>
		<option value="id" <% ($sort_by eq "id") ? "selected" : "" %>>School ID</option>
		<option value="diocode" <% ($sort_by eq "diocode") ? "selected" : "" %>>Diocese Code</option>
		<option value="dioname" <% ($sort_by eq "dioname") ? "selected" : "" %>>Diocese Name</option>
	</select>
</td>
<td width="25%">
	<input  type="submit" value="Re-sort">
	</form>
</td>
<td align="right">
	<form action="school_report_print.mhtml" method="post">
	<input type="hidden" name="sort_by" value="<% $sort_by %>">
	<input  type="submit" value="Print School List">
	</form>
</td>
</tr>
</table>

<hr>

<center>
<table cellpadding="5" cellspacing="1" width="100%">

%	my $switch;

%	foreach my $school (@schools) { 

	<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

	<td><% $school->id %></td>

	<td><% $school->region->code %></td>

	<td><% $school->name %></td>

	<td><% $school->region->name %></td>

	<td align="center">
		<form action="index.mhtml" method="post">
		<input type="hidden" name="school_id" value="<% $school->id %>">
		<input class="skinny" type="submit" value="View">
		</form>
	</td>

	</tr>

%	}	

</table>
</center>



