<%args>
	$account
	$tourn
	$tz
</%args>
<%init>

	my $start = $tourn->start->set_time_zone($tz);
	my $end = $tourn->end->set_time_zone($tz);

	my $reg_start = $tourn->reg_start->set_time_zone($tz);
	my $reg_end = $tourn->reg_end->set_time_zone($tz);

	my $freeze_deadline = $tourn->freeze_deadline->set_time_zone($tz) if $tourn->freeze_deadline;
	my $drop_deadline = $tourn->drop_deadline->set_time_zone($tz) if $tourn->drop_deadline;
	my $judge_deadline = $tourn->judge_deadline->set_time_zone($tz) if $tourn->judge_deadline;
	my $fine_deadline = $tourn->fine_deadline->set_time_zone($tz) if $tourn->fine_deadline;

	$freeze_deadline = $reg_end->clone unless $freeze_deadline;
	$drop_deadline = $reg_end->clone unless $drop_deadline;
	$judge_deadline = $reg_end->clone unless $judge_deadline;
	$fine_deadline = $reg_end->clone unless $fine_deadline;

	my $switch;

</%init>

	<div class="left huge">

		<form action="save.mhtml" method="post">

		<h2>Dates & deadlines</h2>

		<table cellpadding="3" cellspacing="1" width="100%">

			<& /funclib/datepicker.mas, id => "start" &>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

				<th class="">
					Tournament begins
				</th>

				<td class="right">

					<input type="text" name="start" id="start" size="10" value="<% Tab::pickerdate($start) %>">

				</td>

			</tr>

				<tr>
					<td>
					</td>
				</tr>

			<& /funclib/datepicker.mas, id => "end" &>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

				<th class="">
					Tournament ends
				</th>

				<td class="right">
					<input type="text" name="end" id="end" size="10" value="<% Tab::pickerdate($end) %>">
				</td>

			</tr>

				<tr>
					<td>
					</td>
				</tr>


			<& /funclib/datepicker.mas, id => "reg_start", max => $start &> 

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

				<th class="">
					Online registration opens:
				</th>

				<td class="right">
					<input type="text" name="reg_start" id="reg_start" size="10" value="<% Tab::pickerdate($reg_start) %>">
					at
					<& /funclib/timepicker.mas, name => "reg_starttime", time => $reg_start &>


				</td>

			</tr>
				<tr>
					<td>
					</td>
				</tr>


			<& /funclib/datepicker.mas, id => "reg_end" , max => $start &> 

			<tr <% ($switch % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

				<th class="">
					New entries due by:
				</th>

				<td class="right">
					<input type="text" name="reg_end" id="reg_end" size="10" value="<% Tab::pickerdate($reg_end) %>">
					at
					<& /funclib/timepicker.mas, name => "reg_endtime", time => $reg_end &>
				</td>

			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
				
				<td colspan="2" class="explain">
					You can also later set up per-event deadlines once your tournament
					is approved.  After this date, entries cannot be added, but can be
					dropped, name-changed, or judges added. 
				</td>

			</tr>
				<tr>
					<td>
					</td>
				</tr>


			<& /funclib/datepicker.mas, id =>"freeze_deadline" , max => $start &> 

            <tr <% ($switch % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

				<th class="">
					Fees & Obligations frozen on:
                </th>

                <td class="right">
                    <input type="text" name="freeze_deadline" id="freeze_deadline" size="10" value="<% Tab::pickerdate($freeze_deadline) %>">
					at
					<& /funclib/timepicker.mas, name => "freeze_deadlinetime", time => $freeze_deadline &>
                </td>

            </tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
				
				<td colspan="2" class="explain">
					After this date, drops will not delete the competitor from
					the system, and schools will still be charged entry fees and still
					be on the hook for judging for those entries.
				</td>

			</tr>

				<tr>
					<td>
					</td>
				</tr>

			<& /funclib/datepicker.mas, id =>"judge_deadline" , max => $start &> 

            <tr <% ($switch % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

				<th class="">
					Judge information due:
                </th>

                <td class="right">
                    <input type="text" name="judge_deadline" id="judge_deadline" size="10" value="<% Tab::pickerdate($judge_deadline) %>">
					at
					<& /funclib/timepicker.mas, name => "judge_deadlinetime", time => $judge_deadline &>

                </td>

            </tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
				
				<td colspan="2" class="explain">
					Deadline for judge adds, alterations and drops
				</td>

			</tr>

				<tr>
					<td>
					</td>
				</tr>

			<& /funclib/datepicker.mas, id =>"drop_deadline" , max => $start &> 

            <tr <% ($switch % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

				<th class="">
					Online drop & namechange deadline:
                </th>

                <td class="right">
                    <input type="text" name="drop_deadline" id="drop_deadline" size="10" value="<% Tab::pickerdate($drop_deadline) %>">
					at
					<& /funclib/timepicker.mas, name => "drop_deadlinetime", time => $drop_deadline &>
                </td>

            </tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
				
				<td colspan="2" class="explain">

					Allow coaches to drop students and change names on their
					own.  I recommend you set this to just before you expect to
					panel or export the data to TRPC.  It'll reduce the hassle
					you have to deal with. 

				</td>

			</tr>

				<tr>
					<td>
					</td>
				</tr>

			<& /funclib/datepicker.mas, id =>"fine_deadline", max => $start &> 

            <tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

				<th class="">
					Nuisance fines apply after:
                </th>

                <td class="right">

                    <input type="text" name="fine_deadline" id="fine_deadline" size="10" value="<% Tab::pickerdate($fine_deadline) %>">
					at 
					<& /funclib/timepicker.mas, name => "fine_deadlinetime", time => $fine_deadline &>

                </td>

            </tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
				
				<td colspan="2" class="explain">

					After this point, additional drop fines (in addition to
					registration fees) apply to dropped students.  You can set
					drop fine amounts once your tournament is approved.
					Recommend you set this for after you'll have paneled, to
					encourage people to report drops early.

				</td>

			</tr>

			<tr class="liblrow">

				<td colspan="4" class="right">
					<input class="blue" type="submit" value="  Save Dates   ">
					</form>
				</td>

			</tr>
		
		</table>

	</div>

	<div class="right small">

	</div>



