<%args>
	$tourn
	$event_id => undef
	$add => undef
	$err => undef
	$tz => undef
</%args>
<%init>

	$tz = $tourn->tz unless $tz;
 	my @groups = sort{$a->name cmp $b->name} $tourn->judge_groups;

	my $event = Tab::Event->retrieve($event_id) if $event_id;

	if (scalar $tourn->events == 1 && not defined $add) {
		$event = $tourn->events->first;
	}

	my $switch;

</%init>
	
	<& "/funclib/editor.mas" &>

	<div class="left huge">

		<h2><% $event->name %></h2>

		<& tabnav.mas, event => $event, whoami => "messages" &>

		<h4>Message/Rules to print on ballots</h4>
		
		<form action="messages_save.mhtml" method="post">
		<input type="hidden" name="event_id" value="<% $event->id %>">

		<span class="block leftalign">
			<textarea name="ballot_rules" rows=15 cols="58" wrap="virtual"><% ($event) ? $event->setting("ballot_rules") : "" %></textarea>
		</span>

		<h4>Event Description on website</h4>

		<span class="block leftalign">
			<textarea name="description" rows=15 cols="58" wrap="virtual"><% ($event) ? $event->setting("description") : "" %></textarea>
		</span>

		<span class="liblrow rightalign block">
			<input type="submit"  value="  Save Messages ">
			</form>
		</span>

	</div>
			
	<div class="right small">
		<& menu.mas, tourn => $tourn, whoami => "messages", event_id => ($event) ? $event->id : "" &>		
	</div>
