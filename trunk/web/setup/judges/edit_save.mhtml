<%args>
	$circuit
	$tourn
	$group_id => undef
	$name => undef
	$abbr => undef
	$special => undef
	$elim_special => undef
	$judge_per => undef
	$tab_room => undef
	$dio_min => undef
	$min_burden => undef
	$max_burden => undef
	$free => undef
	$ask_alts => undef
	$live_updates => undef
	$alt_max => undef
</%args>
<%init>

	my $msg;

	my $group;

	if ($group_id) { 

		$group = Tab::JudgeGroup->retrieve($group_id);

		$group->name($name);
		$group->abbr($abbr);
		$group->special($special);
		$group->elim_special($elim_special);
		$group->judge_per($judge_per);
		$group->tab_room($tab_room);
		$group->dio_min($dio_min);
		$group->min_burden($min_burden);
		$group->max_burden($max_burden);
		$group->free($free);
		$group->ask_alts($ask_alts);
		$group->live_updates($live_updates);
		$group->alt_max($alt_max);
		$group->update();

		$msg = "Group changes saved";

	} else { 

        $group = Tab::JudgeGroup->create({
            name => $name,
            abbr => $abbr,
            special => $special,
            elim_special => $elim_special,
            tournament => $tourn->id,
            judge_per => $judge_per,
            dio_min => $dio_min,
            min_burden => $min_burden,
            max_burden => $max_burden,
            ask_alts => $ask_alts,
            live_updates => $live_updates,
            alt_max => $alt_max,
            tab_room => $tab_room,
            free => $free,
        });

		$msg = "Group $name created";

	}

	$m->redirect("$Tab::url_prefix/setup/judges/edit.mhtml?group_id=".$group->id."&msg=$msg");

</%init>
