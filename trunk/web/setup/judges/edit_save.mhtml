<%args>
	$circuit
	$tourn
	$group_id => undef
	$name => undef
	$abbr => undef
	$special => undef
	$elim_special => undef
	$judge_per => undef
	$tab_room => undef
	$dio_min => undef
	$min_burden => undef
	$max_burden => undef
	$free => undef
	$deadline => undef
	$ask_alts => undef
	$live_updates => undef
	$alt_max => undef
</%args>
<%init>

	my $msg;

	my $group;

	if ($group_id) { 

		$group = Tab::JudgeGroup->retrieve($group_id);

		$group->name($name);
		$group->abbr($abbr);
		$group->judge_per($judge_per);
		$group->update();

	} else { 

        $group = Tab::JudgeGroup->create({
            tourn => $tourn->id,
            name => $name,
            abbr => $abbr,
            judge_per => $judge_per,
        });

		$msg = "Group $name created";

	}

	$group->setting("special", $special);
	$group->setting("elim_special", $elim_special);
	$group->setting("tab_room", $tab_room);
	$group->setting("dio_min", $dio_min);
	$group->setting("min_burden", $min_burden);
	$group->setting("max_burden", $max_burden);
	$group->setting("free", $free);
	$group->setting("ask_alts", $ask_alts);
	$group->setting("live_updates", $live_updates);
	$group->setting("alt_max", $alt_max);
	$group->setting("special", $special);
	$group->setting("deadline", "date", $deadline);

	$msg = "Group changes saved";

	$m->redirect("$Tab::url_prefix/setup/judges/edit.mhtml?group_id=".$group->id."&msg=$msg");

</%init>
