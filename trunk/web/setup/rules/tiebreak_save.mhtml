<%args>
	$tourn
	$covers
	$tiebreaker
	$count
	$multiplier => 1
	$priority
</%args>
<%init>

	$multiplier = 1 if $multiplier <= 0;

	if ($tiebreaker eq "judgepref" || $tiebreaker eq "coinflip") {

		my @already = Tab::Tiebreak->search( covers => $covers, 
											method => $tourn->method->id,
											 priority => $priority);

		if (@already) { 
			$m->print("<p class=\"err\"> Judges Preference and Coinflips cannot be at the
						same priority level as other tiebreakers.  Hit back on your browser
						and try again. </p>");
			$m->abort;
		}
	}

	my $tiebreak = Tab::Tiebreak->create({
		tiebreaker => $tiebreaker,
		method => $tourn->method->id,
		multiplier => $multiplier,
		count => $count,
		priority => $priority,
		covers => $covers
	});

	my $msg = "Tiebreak saved";

	$m->redirect("tiebreaks.mhtml?msg=$msg");	
	

</%init>

