<%args>
	$tourn
</%args>
<%init>

	my $switch;

	my (%cume_settings) = $m->comp("/funclib/tourn_cume_sweeps.mas", tourn => $tourn);
	my (%place_settings) = $m->comp("/funclib/tourn_place_sweeps.mas", tourn => $tourn);

    my $numero = keys %cume_settings;
	&Tab::debuglog("There is $numero in the cume hopper ");

</%init>

	<& sidebar.mas, tourn => $tourn, chosen => "sweeps" &>

	<div class="left huge">

		<h2>Team Awards/Sweepstakes </h2>

		<div class="half left"> 
		
		<h4>Who counts for sweeps</h4>

		<table cellpadding="5" cellspacing="1" width="100%">

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
			
				<td class="smaller">
					<form action="sweeps_save.mhtml" method="post">
					Sweep based on
				</td>
				
				<td width="30%" class="smaller">

					<input type="radio" id="scb_1" name="sweep_class_based"  value="" 

						<% ($tourn->setting("sweep_class_based") != 1) ? "checked" : "" %> >
						<label for="scb_1">
							Events
						</label>

					<br / style="display: block; margin: 2px;">

					<input type="radio" id="scb_2" name="sweep_class_based"  value="1" 
						<% ($tourn->setting("sweep_class_based") == 1) ? "checked" : "" %> >
						<label for="scb_2">
							Classes
						</label>

				</td>
				
			</tr> 
			
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
			
				<td class="smaller">
					Limit of entries counted per event
				</td>
				
				<td>
					<input type="number" name="sweep_per_event" value="<% $tourn->setting("sweep_per_event") %>" size="5" min="0" max="10000">
				</td>
				
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
    
				<td class="smaller">
					Limit of events counted
				</td>
    			
				<td>
					<input type="number" name="sweep_event_total" value="<% $tourn->setting("sweep_event_total") %>" size="5" min="0" max="10000">
				</td>
				
			</tr> 
			
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
			
				<td class="smaller">
					"Wildcards" counted in addition
				</td>
				
				<td>
					<input type="number" name="sweep_wildcards" value="<% $tourn->setting("sweep_wildcards") %>" size="5" min="0" max="10000">
				</td>

			</tr> 
			
			<tr class="liblrow">

				<td class="rightalign" colspan="4">
					<input  type="submit" value="Save Settings">
				</td>

			</tr> 

		</table>

		</div>

		<div class="half right">
		
		<h4>Use the IE 6 - rank formula</h4>

		<table cellpadding="5" cellspacing="1" width="100%">
			
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

				<td class="smaller">
					<label for="sweep_count_prelims">
					Sweep prelim ranks
					</label>
				</td>

				<td>
					<input type="checkbox" id="sweep_count_prelims" name="sweep_count_prelims"  value="1"
					<% ($tourn->setting("sweep_count_prelims") == 1) ? "checked" : "" %> >
				</td>
				
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >

				<td class="smaller">
					<label for="sweep_count_elims">
					Sweep elim ranks
					</label>
				</td>
    
				<td>
					<input type="checkbox" id="sweep_count_elims" name="sweep_count_elims"  value="1"
        			<% ($tourn->setting("sweep_count_elims") == 1) ? "checked" : "" %> >
    			</td>
				
			</tr> 
			
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
			
				<td class="smaller">
					<label for="sweep_count_finals">
					Sweep final ranks
					</label>
				</td>
				
				<td>
					<input type="checkbox" id="sweep_count_finals" name="sweep_count_finals"  value="1" 
						<% ($tourn->setting("sweep_count_finals") == 1) ? "checked" : "" %> >
						
				</td>
				
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
    
				<td class="smaller">
					<label for="sweep_rank_in_elims">
					Sweep elim & final round placements
					</label>
				</td>
    
				<td>
					<input type="checkbox" id="sweep_rank_in_elims" name="sweep_rank_in_elims" value="1" 
					<% ($tourn->setting("sweep_rank_in_elims") == 1) ? "checked" : "" %> >
				</td>

			</tr> 
			
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
			
				<td class="smaller">
					<label for="sweep_final_rank">
					Sweep on final overall placement
					</label>
				</td>
				
				<td>
					<input type="checkbox" id="sweep_final_rank" name="sweep_final_rank"  value="1"
					<% ($tourn->setting("sweep_final_rank") == 1) ? "checked" : "" %> >
				</td>

			</tr> 
			
			<tr class="liblrow">
				<td class="rightalign" colspan="4">
					<input  type="submit" value="Save Settings"> 
				</td>
			</tr>

		</table>

		</div>

		<br style="clear: both;">

		<div class="half left">

		<table cellpadding="5" cellspacing="1" width="100%">

%			undef ($switch);

			<tr>
				<td colspan="4">
					<h4>Sweep based on advancement</h4>
				</td>
			</tr>

			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
					
				<td class="smaller">
					Points per contestant
				</td>
							
				<td>
					<input type="number" name="points_per_entry" value="<% $tourn->setting("points_per_entry") %>" size="5" min="0" max="10000">
				</td>
							
			</tr>
	
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
		
				<td class="smaller">
					Points per finalist
				</td>
						 
			 	<td>
					<input type="number" name="points_per_finalist" 
					value="<% $tourn->setting("points_per_finalist") %>" size="5" min="0" max="10000">
				</td>
							
			</tr> 
						
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
						
				<td class="smaller">
					Points per elim break
				</td>
						
				<td>
					<input type="number" name="points_per_elim" value="<% $tourn->setting("points_per_elim") %>" size="5" min="0" max="10000">

				</td> 
							
			</tr> 
						
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> > 
						
				<td class="smaller">
					Only give points to finalists
				</td> 
							
				<td>
					<input type="checkbox" name="sweep_only_place_final" value="1"
					<% $tourn->setting("sweep_only_place_final") ? "checked" : "" %> size="5" min="0" max="10000">
				</td> 
							
			</tr> 
				
			<tr class="liblrow">
				<td class="rightalign" colspan="4">
					<input  type="submit" value="Save Settings">
					</form>
				</td>
			</tr> 
						
		</table> 

		</div>

%		undef ($switch);
					
		<div class="half right"> 

			<table cellpadding="5" cellspacing="1" width="100%"> 
				
				<tr>
					<a name="end"></a>

					<td colspan="3">
						<form action="sweep_placement_save.mhtml" method="post">
						<input type="hidden" name="tourn_id" value="<% $tourn->id %>">
						<h4>Points for final overall placement</h4>
					</td>

				</tr>

%				foreach my $sweep (sort {$a <=> $b} keys %place_settings ) { 

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> > 

						<td></td>
							
						<td>
							Place <input size="5" type="number" name="place_<% $sweep %>" value="<% $sweep %>" min="0" max="10000">
						</td> 
								
						<td>
							Points <input size="5" type="number" name="place_value_<% $sweep %>" 
								value="<% $place_settings{$sweep}->value %>" min="0" max="10000">
						</td>
							
					</tr>
%				} 

				<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
					
					<th class="smaller" style="border-top: 1px dotted #999;">
						Add
					</th> 
					
					<td style="border-top: 1px dotted #999;">
						Place <input type="number" size="5" name="place_new" min="0" max="10000">
					</td>

					<td style="border-top: 1px dotted #999;">
						Points <input type="number" size="5" name="place_value_new" min="0" max="10000">
					</td>
							
				</tr>

				<tr class="liblrow">

					<td colspan="3" class="rightalign" >
						<input  type="submit" class="thin" value=" Save ">
					</td>

				</tr> 

			</table> 

%			undef ($switch);

			<table cellpadding="5" cellspacing="1" width="100%"> 
				
				<tr>
				
					<td colspan="3">
						<h4>Points for prelim cume totals</h4>
					</td> 

%					foreach my $sweep (sort {$a <=> $b} keys %cume_settings) { 

						<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
							
							<td></td>
							
							<td> 
								Cume <input size="5" type="number" name="cume_<% $sweep %>" value="<% $sweep %>" min="0" max="10000">
							</td> 
								
							<td>
								Points <input size="5" type="number" name="cume_value_<% $sweep %>" value="<% $cume_settings{$sweep}->value %>" min="0" max="10000">
							</td>

						</tr>
%					}

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\""%> >
					
						<th class="smaller" style="border-top: 1px dotted #999;">
							Add
						</th> 
							
						<td style="border-top: 1px dotted #999;">
							Cume <input type="number" size="5" name="cume_new" min="0" max="10000">
						</td> 
								
						<td style="border-top: 1px dotted #999;">
							Points <input type="number" size="5" name="cume_value_new" min="0" max="10000">
						</td>
								
					</tr> 
						
					<tr class="liblrow">
							
						<td colspan="3" class="rightalign">
							<input  type="submit" class="thin" value=" Save ">
							</form>
						</td>
							
					</tr> 
							
					<tr class="oddrow">
						<td colspan="4">
						</td>
					</tr> 
						
			</table>

		</div>


	</div>

