<%args>
	$tourn
	$timeslot_id => undef
	$event_id => undef
	$speaker_order => undef
	$err => undef
</%args>

	<h3>Record Extemp questions chosen</h3>

	<table cellpadding="5" cellspacing="1" width="100%">

	<tr class="liblrow">

		<th>
			Event:
		</th>
		
		<td>
			<form action="extemp_questions.mhtml" method="post">

			<select name="event_id">

%				foreach my $event (sort {$a->name cmp $b->name} $m->comp("/funclib/tourn_events.mas", tourn => $tourn)( type => "speech" ) ) { 
					<option <% ($event->id == $event_id) ? "selected" : "" %> value="<% $event->id %>"><% $event->name %></option> 
%				}

			</select>

		</td>
	
		<th>
			Timeslot:
		</th>

		<td>
			<select name="timeslot_id">
%				foreach my $timeslot (sort {$a->start->epoch <=> $b->start->epoch} $tourn->timeslots) { 
					<option <% ($timeslot_id == $timeslot->id) ? "selected" : "" %> value="<% $timeslot->id %>"><% $timeslot->name %></option> 
%				}
			</select>
		</td>

		<th>
			Speaker
		</th>

		<td>
			<select name="speaker_order">
%				foreach my $order (1 .. 8 ) { 
					<option <% ($order == $speaker_order) ? "selected" : "" %> value="<% $order %>"><% $order %></option> 
%				}
			</select>

		</td>

		<td>
			<input type="submit" value="   Show Speakers ">
			</form>
		</td>

	</table>

<%perl>

	if ($event_id && $timeslot_id && $speaker_order) { 

		my $switch;
		my $event = Tab::Event->retrieve($event_id);
		my $timeslot = Tab::Timeslot->retrieve($timeslot_id);
		my @entries = $event->entries_by_timeslot_and_order($timeslot, $speaker_order);

		@entries = sort {length($a->letter) <=> length($b->letter)} @entries;

</%perl>

	<div class="left huge">

	<h4><% $event->name %> in slot <% $timeslot->name %> speaker <% $speaker_order %></h4>

	<form action="extemp_draw_save.mhtml" method="post">
	<input type="hidden" name="event_id" value="<% $event_id %>">
	<input type="hidden" name="timeslot_id" value="<% $timeslot_id %>">
	<input type="hidden" name="speaker_order" value="<% $speaker_order %>">

	<center>

	<table cellpadding="5" cellspacing="1" width="100%">

%		foreach my $entry (@entries) { 
			<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
				<th><% $entry->letter %></th>
				<th><% $entry->code %></th>
				<td><input type="text" name="<% $entry->id %>" 
					value="<% $entry->question_by_timeslot($timeslot) %>" size="10"></td>
			</tr>
%		}

	<tr class="liblrow">
		<td colspan="3" align="center">
		<input type="submit" value="   Save Extemp Draw    ">
		</td>
	</tr>

	</table>

	</div>


	<br style="clear: both;">

%	}

