<%args>
	$round_id
</%args>
<%init>
	
	my $round = Tab::Round->retrieve($round_id);
	my $event = $round->event;
	my $tourn = $event->tournament;
	my $circuit = $tourn->circuit;

	unless ($round->published) { 

		$m->print("<p class=\"err\">This round has not been published.  Quit trying to mess around</p>");
		$m->abort;

	}

</%init>

<h3><% $round->event->name %> <% ($round->label) ? $round->label : "Round ".$round->name %></h3>

%	my $start = $round->timeslot->start;
%	$start->set_time_zone($circuit->timezone);

<h4>Round scheduled for <% $start->hour_12.":".$start->strftime('%M')." ".$start->strftime('%p') %></h4>


<table cellpadding="5" cellspacing="1" width="100%">

	<tr><th>Panel</th>
		<th>Room</th>
		<th style="border-right: 1px solid brown;">
		Judges</th>
		<th colspan="7">Competitors</th>
	</tr>

%	my $switch;
% 	foreach my $panel (sort {$a->letter cmp $b->letter} $round->panels) { 
%	$switch++;

	    <tr <% ($switch % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

		<th>
		<% $panel->letter %>
		</th>

		<td>
		<% ($panel->room) ? $panel->room->name : "" %>
		</td>	

		<td style="border-right: 1px solid brown;">
%	foreach my $judge ($panel->judges) { 
		<% ($judge->school->id ) ? ($judge->school->code) ? $judge->school->code : "" : "" %>
		<% $judge->code %>
% 	}
		</td>

% 	my @comps = $panel->comps unless $circuit->diocese_based;
%	@comps = $panel->comps_region if $circuit->diocese_based;

%	my $count;
% 	foreach my $comp (@comps) { 

%	if ( ($event->type eq "speech" && $count == 7) 
%	  || ($event->type eq "congress" && $count == 4)
%	  || ($tourn->method->schemat_display eq "full_names" && $count == 4)
%	  || ($tourn->method->schemat_display eq "last_names" && $count == 5)) {
		</tr>
	    <tr <% ($switch % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
		<td style="border-right: 1px solid brown;" colspan="3"><br />
		</td>
%		$count = 0;
%	}

	<td>
%		if ($event->type eq "speech") { 
		
%			if ($tourn->method->schemat_school_code) { 
					<% $comp->school->code %>
%			}

%			if ($tourn->method->schemat_display eq "last_names") { 
					<% $comp->student->last %>
%				if ($event->team == 2) { 
					<% $comp->partner->last %>
%				}
%			}

%			if ($tourn->method->schemat_display eq "full_names") { 
					<% $comp->student->first." ".$comp->student->last %>
%				if ($event->team == 2) { 
					<% $comp->partner->first." ".$comp->partner->last %>
%				}
%			}

%			if ($tourn->method->schemat_display eq "codes") { 
					<% $comp->code %>
%			}

%		}

%		if ($event->type eq "congress") { 
			<% $comp->student->first." ".$comp->student->last."<br /> ".$comp->school->name %> 
%		}
	
		</td>
%		$count++;

%	} # end of foreach comp

</tr>

%	} #end of foreach panel  

</table>
