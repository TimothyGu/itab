<%args>
	$event_id    => 24885

</%args>

<%init>

	use Data::Dumper;
	
	my @ballots;
	Tab::Ballot->columns(TEMP => qw/panel_bye/);						
	Tab::Ballot->columns(TEMP => qw/ballot_bye/);
	Tab::Ballot->columns(TEMP => qw/student/);
	Tab::Ballot->columns(TEMP => qw/tag/);
	Tab::Ballot->columns(TEMP => qw/score /);
	Tab::Ballot->columns(TEMP => qw/round /);
	Tab::Ballot->set_sql(pull_entry => "
		SELECT ballot.*, round.name as round, ballot_value.student as student, ballot_value.tag as tag, ballot_value.value as score
		FROM ballot, entry, panel, round, ballot_value
		WHERE entry.event=24885
		and ballot.entry=entry.id
		and ballot_value.ballot=ballot.id
		and ballot_value.tag <> 'rfd'
		and panel.id=ballot.panel
		and round.id=panel.round
		order by entry.name asc, round.id asc, ballot_value.student asc
	");
	@ballots = Tab::Ballot->search_pull_entry;

#	my %team_record;
#	foreach my $team (@team_record) {
#		$team_record{$team->id}{teamname} = $team->name;
#		$team_record{ID} = $team->ID;
#	}
	
</%init>

	<& menu.mas &>

	<h2> A table </h2>

	<a onclick="showall();" >Show All</a> <a onclick="hideall();" >Hide All</a> 
	
	<div class="left huge">

	<script>
		
		functiontest = function() {
			var MasterTable = document.getElementById("table_body");
			var TableRows = MasterTable.getElementsByTagName("tr");
			for (var i = 0; i < TableRows.length; i++) {
				TableRows[i].style.display = (TableRows[i].style.display === "none") ? "table-row" : "none" ;
			}
			
		}

		showall = function() {
			var MasterTable = document.getElementsByTagName("tr");
			for (var i = 0; i < MasterTable.length; i++) {
				MasterTable[i].style.display = "table-row";
			}
			
		}

		hideall = function() {
			var MasterTable = document.getElementsByClassName("none");
			for (var i = 0; i < MasterTable.length; i++) {
				MasterTable[i].style.display = "none";
			}
			
		}

		var row_name ="team1";
		functiontest2 = function(row_name) {
//			var TableRows = document.getElementsByName("team1");
//			window.alert("Received variable is:" + row_name);
			var TableRows = document.getElementsByName(row_name);
			for (var i = 0; i < TableRows.length; i++) {
				TableRows[i].style.display = (TableRows[i].style.display === "none") ? "table-row" : "none" ;
			}
			
		}
		
	</script>
	
	<table cellpadding="3" width="100%" id="WUDC" class="tablesorter">

		<tbody id="table_body">

			<tr class="dkgreen" > 
				<td>Cal State Fullerton</td>
				<td>Josh Clark & Cameron Ward</td>
				<td>7-1</td>
				<td>367.2 pts/1st seed</td>
				<td align="right"><a onclick="functiontest2('team1');">hide/show</a></td>
			</tr>	

			<tr class="none" style="display:none" name="team1" bgcolor="GreenYellow" > 
				<td>Round</td>
				<td>Judge</td>
				<td>Decision</td>
				<td>Clark</td>
				<td>Ward</td>
			</tr>	

			<tr class="none" style="display:none" name="team1" > 
				<td>1</td>
				<td>Shanahan</td>
				<td>Win</td>
				<td>28.5</td>
				<td>29.1</td>
			</tr>	

			<tr class="none" style="display:none" name="team1" > 
				<td>2</td>
				<td>Hall</td>
				<td>Win</td>
				<td>28.8</td>
				<td>29.7</td>
			</tr>	
		

			<tr class="dkgreen" > 
				<td>Cal State Fullerton</td>
				<td>Amy Dempster & Josh Pang</td>
				<td>5-3</td>
				<td>380.2 pts/12th seed</td>
				<td align="right"><a onclick="functiontest2('team2');">hide/show</a></td>
			</tr>	

			<tr class="none" style="display:none" name="team2" bgcolor="GreenYellow" > 
				<td>Round</td>
				<td>Judge</td>
				<td>Decision</td>
				<td>Dempster</td>
				<td>Pang</td>
			</tr>	

			<tr class="none" style="display:none" name="team2" > 
				<td>1</td>
				<td>Shanahan</td>
				<td>Win</td>
				<td>28.5</td>
				<td>29.1</td>
			</tr>	

			<tr class="none" style="display:none" name="team2" > 
				<td>2</td>
				<td>Hall</td>
				<td>Win</td>
				<td>28.8</td>
				<td>29.7</td>
			</tr>	

		</tbody>

		</table>

		<table>
			<tbody id="table_body">

			<tr>
				<td>entry</td>
				<td>round</td>
				<td>judge</td>
				<td>student</td>				
				<td>score</td>				
				<td>value</td>												
			</tr>

%			foreach my $ballot (@ballots) {
			<tr>
				<td><% $ballot->entry %></td>
				<td><% $ballot->round %></td>
				<td><% $ballot->judge %></td>
				<td><% $ballot->student %></td>				
				<td><% $ballot->tag %></td>				
				<td><% $ballot->score %></td>												
			</tr>
%			}	

			</tbody>
		</table>	
	</div>
