<%args>
	$account => undef
	$tourn_id
</%args>
<%init>

	unless ($account) { 
		my $err = "You must be logged into a tabroom.com account to follow a school.  Log in above";
		$m->redirect("index.mhtml?tourn_id=$tourn_id&err=$err");
	}

	my $tourn = Tab::Tourn->retrieve($tourn_id);

	my ($e, $j, $schref) = $m->comp("/funclib/account_follows.mas", account => $account, tourn => $tourn);

	my %already = ();

	foreach my $sch (@{$schref}) { 
		$already{$sch->id}++;
	}

</%init>

	    <& sidebar.mas, tourn_id => $tourn_id, whoami => "schools" &>

	    <div class="left huge">

			<h3>Follow an entire school's entries </h3>

			<p>Tap a school to get a master text message or email for an entire
			school's assignments.  Fair warning: these messages can be quite
			large and if sent by text will likely be divided between multiple
			messages.</p>

%			foreach my $school (sort {$a->name cmp $b->name} $tourn->schools) { 
				<a class="biggishspan <% $already{$school->id} ? "blue" : "grey" %>  block smallish padmore" 
					href="<% $already{$school->id} ? "update_remove.mhtml" : "school_follow.mhtml" %>?school_id=<% $school->id %>&tourn_id=<% $tourn_id %>">
					<% $school->code.": ".$school->name %>
				</a>
%			}

	
		





		</div>

