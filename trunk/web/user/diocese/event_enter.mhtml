<%args>
	$account
	$diocese_id
	$event_id
</%args>
<%init>

	my $diocese = Tab::Region->retrieve($diocese_id);
	my $event = Tab::Event->retrieve($event_id);
	my $tourn = $event->class->judge_group->tournament;

	my @comps = sort {$a->id <=> $b->id} $diocese->event_comps($event);
	my @chapters = sort {$a->name cmp $b->name} $diocese->chapters;

</%init>

	<div class="left huge">

		<h2><% $event->name %> Entry</h2>

		<table cellpadding="5" cellspacing="1" width="100%">

			<tr class="liblrow">

				<td class="smaller">
					<form action="event_save.mhtml" method="post">
					<input type="hidden" name="diocese_id" value="<% $diocese->id %>">
					<input type="hidden" name="event_id" value="<% $event->id %>">
					First Name
				</td>

				<td class="smaller">
					Last Name
				</td>

				<td class="smaller">
					Gender
				</td>

				<td class="smaller">
					School
				</td>

				<td class="smaller">
					ADA*
				</td>

				<td class="smaller">
					DROP
				</td>


			</tr>

%		my $switch;

%		foreach my $tag (1 .. $diocese->quota) { 

%			my $comp = shift @comps if @comps;

			<tr <% ($switch % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %> style="border-top: 1px solid #343434;">

				<td class="top">
					<input type="text" size="10" name="student_first_<% $tag %>" value="<% ($comp) ? $comp->student->first : "" %>">
				</td>

				<td class="top">
					<input type="text" size="10" name="student_last_<% $tag %>" value="<% ($comp) ? $comp->student->last : "" %>">
				</td> 

				<td class="top">
					<input type="radio" name="student_gender_<% $tag %>" value="F" <% ($comp && $comp->student->gender eq "F") ? "checked" : "" %>>F
					<input type="radio" name="student_gender_<% $tag %>" value="M" <% ($comp && $comp->student->gender eq "M") ? "checked" : "" %>>M
				</td>


				<td align="center" class="top">
					<select name="chapter_id_<% $tag %>" style="font-size: 70%;">

%						foreach my $chapter (@chapters) {
							
							<option value="<% $chapter->id %>"  <% ($comp) ? ($comp->student->chapter->id == $chapter->id) ? "selected" : "" : "" %> >
								<% substr($chapter->name,0,15) %>
							</option>
%						} 

					</select>
				</td>

				<td align="center" class="top">
					<input type="checkbox" name="ada_<% $tag %>" value="1" <% ($comp && $comp->ada) ? "checked" : "" %>>
				</td>

				<td align="center" class="top">
					<input type="checkbox" name="drop_<% $tag %>" value="1">
				</td>

			</tr>

%			if ($event->team == 2) { 

				<tr <% ($switch % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

					<td>
						<input type="text" size="10" name="partner_first_<% $tag %>" value="<% ($comp) ? $comp->partner->first : "" %>">
					</td>

					<td>
						<input type="text" size="10" name="partner_last_<% $tag %>" value="<% ($comp) ? $comp->partner->last : "" %>">
					</td> 

					<td>
						<input type="radio" name="partner_gender_<% $tag %>" value="F" <% ($comp && $comp->partner->gender eq "F") ? "checked" : "" %>>F
						<input type="radio" name="partner_gender_<% $tag %>" value="M" <% ($comp && $comp->partner->gender eq "M") ? "checked" : "" %>>M
					</td>

					<td colspan="3">
					</td>

				</tr>

%			}

%			$switch++;

%		}

		<tr class="liblrow">

			<td class="top" colspan="7" align="right">

				<input type="submit" value="  Save Entry   ">
				</form>

			</td>

		</tr>

		</table>

		<br />

		<p class="smaller" >

			*ADA: Please check this box if the entry needs special accomodation
			under the Americans With Disabilities Act.  Please email the
			tournament staff with details about the accomodation necessary.

		</p>

	</div>

	<& sidebar.mas, diocese => $diocese, event => $event, tourn => $tourn &>

