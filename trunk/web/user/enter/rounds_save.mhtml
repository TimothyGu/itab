<%args>
	$id
	$value
</%args>
<%flags>
	inherit => undef
</%flags>
<%init>

	my $err;

	my $judge = Tab::Judge->retrieve($id);

	return unless $judge;
	return unless $judge->judge_group;
	return unless $judge->judge_group->setting("rounds_per");

	my $max_rounds = $judge->judge_group->setting("max_rounds");

	if ($value > $max_rounds) { 
		my $err = "Maximum number of rounds a single judge can cover is $max_rounds";
		$m->print('<script type="text/javascript" language="javascript"> $(document).ready(function() { $.jGrowl("'.$err.'", { header: "All set", life: 4000  }); }); </script>');
		$value = $max_rounds;
	}

	$judge->obligation($value);
	$judge->update;

	$m->print($value);

	return;
		
</%init>
