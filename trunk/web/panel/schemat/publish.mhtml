<%args>
	$round_id
	$type => undef
	$published => 1
</%args>
<%init>

	my $round = Tab::Round->retrieve($round_id);
	my $msg;

	if ($type eq "motion") { 

		if ($round->motion_published) { 
			$round->motion_published("");
			$msg = "Round has been removed from the public website";
		} else { 
			$round->motion_published(1);
			$msg = "Round has been published on the public website";
		}

	} else {

		if ($published == 2 && $round->published == 1) { 
			$round->published($published);
			$msg = "Judges have been removed from the public posting";
		} elsif ($round->published) { 
			$round->published("");
			$msg = "Round has been removed from the public website";
		} else { 
			$round->published($published);
			$msg = "Round has been published on the public website";
			$msg .= " without judges" if $published == 2;
		}
	}

	$round->update;
	$m->redirect("show.mhtml?round_id=$round_id&msg=$msg");

</%init>
