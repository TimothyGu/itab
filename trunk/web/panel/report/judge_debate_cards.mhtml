<%args>
	$session
	$group_id	
	$tourn
	$codes => undef
</%args>
<%init>

	my $group = Tab::JudgeGroup->retrieve($group_id);

	my $name = $group->name;
	$name =~ s/[\W_]//g;

	my $filename = "DebateJudgeCards-$name-".$session->id;
	my $filepath = $Tab::file_root."tmp/".$filename;
	`rm -f $filepath.*`;

	$m->comp("/funclib/printout.mas", filename => $filename, head => 1 );

	open (TEXOUT, ">>$filepath.tex");

	foreach my $judge (sort {$a->code <=> $b->code} $group->judges) {

		next unless $judge->active;

		my $qualstring = $m->comp("/funclib/judge_rating.mas", judge => $judge, print => "yes");

		print TEXOUT "\\begin{tabular}{p{1.5in}p{3.0in}p{1.5in}}\n";
		print TEXOUT "\\hline\n";
		print TEXOUT "\\it ".$group->name." & $qualstring & \\multirow{3}{*}{\\Huge \\bf ".$judge->school->code." ".$judge->code." }\\\\ \n";

		print TEXOUT "Name: & ".&Tab::texify($judge->first." ".$judge->last)." & \\\\ \n";

		print TEXOUT "School: & ".&Tab::texify($judge->school->name)." \\\\ \n" if $judge->school;
		print TEXOUT "School: & HIRED  \\\\ \n" unless $judge->school;

		print TEXOUT "\\end{tabular}\n";
		print TEXOUT "\\vspace{.03in}\n";
		print TEXOUT "\\newline\n";

		print TEXOUT "\\raggedright\n";
		print TEXOUT "\\renewcommand{\\arraystretch}{1.6}\n";

		print TEXOUT "\\begin{tabular}{|p{.5in}|p{2.5in}|p{2.5in}|p{.75in}|} \n";

		print TEXOUT "\\rowcolor[rgb]{.84,.89,.94}\n";

		print TEXOUT "\\hline \n";
		print TEXOUT "Round & Aff & Neg & Voted \\\\ \n";

		foreach my $round (1 .. 7) { 

			print TEXOUT "\\hline \n";
			print TEXOUT "\\rowcolor[rgb]{1,.9,.9}\n" unless ($round % 2);
			print TEXOUT " $round & & & \\\\ \n";

		}

		print TEXOUT "\\hline \n";

		print TEXOUT "\\end{tabular}\n";
		
		print TEXOUT "\\vspace{.5in}\n";
		print TEXOUT "\\newline\n";

		print TEXOUT "\\renewcommand{\\arraystretch}{1.2}\n";

	}

	close TEXOUT;

	$m->comp("/funclib/printout.mas", filename => $filename, tail => 1 );

</%init>
