<%args>
	$tourn
	$event_id
	$timeslot_id
</%args>
<%init>

	use POSIX;

	my $tz = $tourn->tz;
	$tz = "UTC" unless $tz;
	
	my $tourn_id = $tourn->id;

	my $event = Tab::Event->retrieve($event_id);
 	my $timeslot = Tab::Timeslot->retrieve($timeslot_id);

	my @rounds = Tab::Round->search( timeslot => $timeslot->id, event => $event->id);
		
</%init>

	<script type="text/javascript">

		$(document).ready(function() {

			$('.body').css('background-image', 'none');
			$('.body').css('background-color', '#dadada');

			$('#slideshow').cycle({
				fx      : 'scrollDown',
				sync    : false,
				timeout : 15000,
				pause   : 1
			});

			$('#navbar').hide();
			$('#topbar').hide();
			$('#header').hide();
			$('#footer').hide();

			$("#slideshow_begin").click(function() {
				$("#slideshow_begin").hide();
				$('#pause').show();
				$('#slideshow').css('display', 'block');
				$('#slideshow').css('width', '650px');
				$('#slideshow').css('height', '475px');
				$('#slideshow').css('margin', 'auto');
				$('#slideshow').cycle('resume');
			});

			$("#pause").click(function() {
				$('#pause').hide();
				$('#resume').show();
				$('#slideshow').cycle('pause');
			});

			$("#resume").click(function() {
				$('#pause').show();
				$('#resume').hide();
				$('#slideshow').cycle('resume');
			});

		});

	</script>

	<div class="blankfull roundback">
		

		<div id="slideshow_begin" class="slideshow_begin">
			BEGIN SLIDESHOW
		</div>

		<div id="slideshow" class="slideshow_round" style="display: none;">

%			foreach my $round (@rounds) { 

%				my $start = $round->start_time;
%				$start = $round->timeslot->start unless $start;
%				$start->set_time_zone($tz);
%				my $start_string = Tab::nicetime($start);

%				if ($round->type eq "final" || $round->type eq "elim") { 

%					foreach my $panel (sort {$a->letter cmp $b->letter} $round->panels) { 

						<span class="slideshow_oneround">

							<h2><% $round->realname %> <% $panel->letter %></h2>

							<span class="slideshow_half"> 
								<% $panel->room ? "<h5>Room</h5>" : "" %>
								<% $panel->room ? "<h4>". $panel->room->name." </h4>" : "" %>
							</span>
							<span class="slideshow_half"> 
								<h5>Start</h5>
								<h4><% $start_string %></h4>
							</span>

							<br />

%							foreach my $entry ($m->comp("/funclib/panel_entries.mas", panel => $panel)) { 
								<span class="slideshow_elim">
									<% $entry->code %>
								</span>
%							}

							<br />

							<span class="slideshow_panel">
%								foreach my $judge ($m->comp("/funclib/panel_judges.mas", panel => $panel)) { 
									<span class="slideshow_judge <% $judge->chair ? "bold" : "" %> ">
										<% $judge->chair ? "*" : "" %><% $judge->last %>, <% $judge->first %> 
									</span>
%								}
							</span>

						</span>

%					}


%				} else { 
					<span class="fiverounds">
					</span>
%				}
%			}

		</div>

		<div class="block centeralign padmore">

			<div id="pause" class="slideshow_command" style="display: none;">
				&lt;Pause&gt;
			</div>

			<div id="resume" style="display:none;" class="slideshow_command redtext">
				&gt;Resume&lt;
			</div>

		</div>

		<div class="slideshow_logo">
			<img src="/lib/images/idea-logo-small.png" alt="International Debate Education Association Logo">
		</div>

		<div class="slideshow_motto">
			<a href="/panel/report/index.mhtml">
				>> Return to Tabroom
			</a>
		</div>



	</div>


	
