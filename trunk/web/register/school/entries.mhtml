<%args> 
	$tourn
	$all => undef
	$event_id => undef
	$school_id => undef
</%args>
<%init>

	my $school = Tab::School->retrieve($school_id);

	my @events;

	if ($event_id) { 
		Tab::debuglog("No idea");
		$events[0] = Tab::Event->retrieve($event_id);
	} else { 

		@events = sort {$a->name cmp $b->name} $m->comp("/funclib/tourn_events.mas", tourn => $tourn);

		if (scalar @events == 1) { 
			$event_id = $events[0]->id;
		}
	} 

 	my $switch;

</%init>

	<& /register/menubar.mas, school => $school, whoami => "students", tourn => $tourn &>

%	 if ($event_id || $all) { 

%		foreach my $event (@events) { 
			<& event_show.mas,  event => $event, school => $school &>
%		}

%		if ($event_id) { 
			<& entry_add.mas,  event => $events[0], school => $school &>
%		}

%	} else {

		<h3>Select a division</h3>

		<p>Choose an division/event at right to see entries</p>

%	} 

	</div>

	<& entry_menu.mas, tourn => $tourn, school => $school, event_id => $event_id &>

