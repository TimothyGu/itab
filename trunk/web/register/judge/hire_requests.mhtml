<%args>
	$circuit
	$tourn
	$group_id
	$tz
</%args>

<%init>

	my $group = Tab::JudgeGroup->retrieve($group_id);

	my @requests = $group->hires;
 	@requests = sort {$a->request_made->epoch <=> $b->request_made->epoch} @requests;

</%init>

    <& sidebar.mas, tourn => $tourn, whoami => "requests", group => $group &>

	<div class="left huge">
				
		<h3><% $group->abbr %> judge requests</h3>

		<table cellpadding="5" cellspacing="1" width="100%">

			<tr class="liblrow">

				<th class="smaller">
					School
				</th>

				<th class="smaller">
					Request Made
				</th>

				<th class="smaller">
					# <% ($group->uncovered_entry_fee) ? "Entries Covered" : "Judges Reqested" %>
				</th>

				<th class="smaller">
					# Accepted
					<form action="hire_requests_save.mhtml" method="post"> 
					<input type="hidden" name="group_id" value="<% $group->id %>">
				</th>

			</tr>

%			my $switch;

%			foreach my $req (@requests) {

%				my $day = $req->request_made->set_time_zone($tourn->tz);

%					if ($req->covers > $req->accepted) { 
					 	<tr <% ($switch++ % 2) ? "class=\"redrow\"" : "class=\"lirdrow\"" %>>
%					} else { 
		 				<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>
%					}

					<td>
						<a class="whiteblock" href="/register/registration.mhtml?school_id=<% $req->school->id %>">
							<% $req->school->name %>
						</a>
					</td>
	
					<td class="smaller">
						<% &Tab::niceshortdt($day->set_time_zone($tz)) %>
					</td>

					<td class="center">
						<input 	type="text" name="<% $req->id %>_covers" size="4" value="<% ($group->uncovered_entry_fee) ? $req->covers : $req->covers / $group->setting("judge_per") %>">
					</td>

					<td class="center">
						<input 	type="text" name="<% $req->id %>_accepted" size="4" value="<% ($group->uncovered_entry_fee) ? $req->accepted : $req->accepted / $group->setting("judge_per") %>">
					</td>

				</tr>

%			}

			<tr class="liblrow">
			
				<td colspan="5" align="right">
					<input type="submit"  value="Save Changes and Notify Coaches">
					</form>
				</td>

			</tr>

		</table>

	</div>
