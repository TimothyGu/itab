<%args>
	$circuit
	$tourn	
	$account
	$session
	$debug
</%args>
<%init> 

	my @judges = $m->comp("/funclib/tourn_judges.mas", tourn => $tourn);
	my %judges_by_name = ();
	my %judges_by_id = ();

	foreach my $judge (@judges) { 

		push (@{$judges_by_name{$judge->first.":".$judge->last}}, $judge);
		system "$Tab::logger Pushing judge ".$judge->id." into ".$judge->first.":".$judge->last if $debug && $judge->last eq "Palmer";
		$judges_by_id{$judge->id} = $judge;
	}

	my $switch;
	my $count = 1;

</%init>

	<& "menu.mas", tourn => $tourn, whoami => "prefs" &>

	<div class="left huge">
	
		<h2>I disapprove of your shenanigans</h2>

		<h4><% scalar @judges %> judges.  Double-registered: </h4>

		<table cellpadding="5" cellspacing="1" width="100%">

%			foreach my $name (keys %judges_by_name) {

%				my @judges = @{$judges_by_name{$name}};
%				next unless scalar @judges > 1;

				<tr class="liblrow">
					<td colspan="5">Shenanigan <% $count++ %>:</td>
				</tr>

%				foreach my $judge (@judges) { 

					<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>>

						<td>
							<a href="/register/judge/edit.mhtml?judge_id=<% $judge->id %>">
							<% ($judge->code) ? $judge->code : "No Code" %>
							</a>
						</td>

						<td>
							<% $judge->judge_group->abbr %>
						</td>

			
						<td>
							<% $judge->first." ".$judge->last %>
						</td>

						<td>
							<% ($judge->school) ? $judge->school->name : "Hired" %>
						</td>

%						if ($tourn->setting("ncfl")) { 
				
							<td>
								<% ($judge->school && $judge->school->region) ? $judge->school->region->name : "" %>
							</td>
%						}

					</tr>

%				}

%			}

		</table>

	</div>
