<%args> 
	$tourn
	$entry_id => undef
</%args>
<%init>

	my $switch;
	my $entry = Tab::Entry->retrieve($entry_id);

	my $school = $entry->school;
	my $diocese = $m->comp("/school_region.mas", school => $school) if $tourn->setting("ncfl");

	my $group = $entry->event->judge_group;

 	my @panels = $m->comp('/funclib/entry_panels.mas', entry => $entry);
	
</%init>

   	<& "/register/menubar.mas", school => $school, whoami => "entries", tourn => $tourn &>

	<h4>Pref Sheet for <% $entry->name %></h4>

		<table cellpadding="5">

%		if ($group->setting("entry_ordinals")) { 

				<tr class="yellowrow">

					<th>
						Judge
					</th>

					<th class="centeralign">
						Rounds/Hired
					</th>

					<th class="centeralign">
						Rating
					</th>

				</tr>

%				my $switch;
%				foreach my $rating (sort {$a->ordinal <=> $b->ordinal} $entry->ratings) { 

					<tr class=<% ($switch++ % 2) ? "oddrow" : "class=evenrow" %>> 

						<td>
							<% $rating->judge->first." ".$rating->judge->last %>
						</td>

						<td class="centeralign">
							<% $rating->judge->obligation %>/<% $rating->judge->hired %>
						</td>

						<td class="centeralign">
							<% $rating->ordinal %>
						</td>

					</tr>

%				}
%			}

		</table>

	</div>

	<div class="right small">

		<div class="sidenote">

			<h4>Return</h4>
			
			<a class="yellow block" href="edit.mhtml?entry_id=<% $entry_id %>">
				Return to <% $entry->name %>
			</a>

		</div>

		<div class="sidenote">

			<h4>Other Pref Sheets</h4>

%			foreach my $other (Tab::Entry->search( event => $entry->event->id, school => $entry->school->id, waitlist => 0, unconfirmed => 0, dropped => 0)) { 

%				next if $other->id == $entry->id;
			
				<a class="nowrap blue block" href="prefs.mhtml?entry_id=<% $other->id %>">
					<% $other->name %> (<% $other->code %>)
				</a>

%			}
			

		</div>

	</div>


	</div>

