<%args>
	$tourn
</%args>
<%init>

	Tab::Event->set_sql(breakable => "    
		select distinct event.* from event
		where event.tourn = ?

		and exists (
			select p2.id from panel as p2,round as r2
			where p2.round = r2.id
			and r2.event = event.id )

		and not exists (
			select ballot.id from ballot,entry,panel,round
				where panel.event = event.id
				and panel.round = round.id
				and ballot.panel = panel.id
				and ballot.entry = entry.id
				and entry.dropped = 0
				and ballot.audit = 0
			)
	");

</%init>
