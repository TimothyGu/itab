<%args>
	$tourn
	$school_id
</%args>
<%init>

    $m->comp("sweep_entries.mas", tourn => $tourn);

	my $school = Tab::School->retrieve($school_id);

	my %entries_counted = $m->comp("school_count.mas", school => $school, tourn => $tourn);

	my $school_points;

	foreach my $comp ($school->entries) {
	   	$school_points = $school_points + $comp->sweeps_points if $entries_counted{$comp->id};

    }

</%init>

%	my $switch;

	<table cellpadding="0" width="100%"> 
	
		<tr>
			<td width="100%">
				<h3><% $tourn->name %> report for <% $school->chapter->name %></h3>
			</td>
			
			<td>
				<form action="printouts.mhtml" method="post">
				<input  type="submit" value="Return to Results">
				</form>
			</td>

		</tr>
		
	</table>

	<table cellpadding="5" width="100%" cellspacing="0"> 
	
		<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>> 
			
			<td colspan="6" align="center">Total Points:
			
				<b><% $school_points %></b>

			</td>
			
		</tr> 

% 			foreach my $comp (sort {$a->code <=> $b->code} $school->entries) {

				<tr <% ($switch++ % 2) ? "class=\"oddrow\"" : "class=\"evenrow\"" %>> 
				
					<td>
						<% $comp->code %>
					</td>

					<td>
						<% $comp->event->abbr %>
					</td>

					<td>
						<% substr($comp->team_name,0,30) %>
  					</td>


%					if ($comp->dropped == 1) {

						<td>
							DROP
						</td>

%					} else  {

						<% ($entries_counted{$comp->id}) ? "<th>".$comp->sweeps_points : "<td>".$comp->sweeps_points %></td>

%					}

					<td>

%	foreach my $ballot (Tab::Ballot->search_ordered_by_round($comp->id)) { 
		<% $ballot->rank %>
		<% ($ballot->rank != $ballot->real_rank) ? "(".$ballot->real_rank.")" : "" %>
%	}
		</td>


</tr>

% }


</table>


