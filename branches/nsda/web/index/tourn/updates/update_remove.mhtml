<%args>
	$account
	$judge_id   => undef
	$entry_id   => undef
	$tourn_id   => undef
	$event_id   => undef
	$school_id  => undef
	$follow_id  => undef
	$jfollow_id => undef
</%args>
<%init>

	$m->redirect("/user/home.mhtml") unless $account && $account->id;

	if ($entry_id) { 
		my @follows = Tab::FollowEntry->search(entry => $entry_id, follower => $account->id);
		foreach (@follows) { $_->delete; }
	}

	if ($judge_id) { 
		my @follows = Tab::FollowJudge->search(judge => $judge_id, follower => $account->id);
		foreach (@follows) { $_->delete; }
	}

	if ($school_id) { 
		my @follows = Tab::FollowSchool->search(school => $school_id, follower => $account->id);
		foreach (@follows) { $_->delete; }
	}

	if ($follow_id) { 
		my $fol = Tab::FollowEntry->retrieve($follow_id);
		$fol->delete if $fol;
	}

	if ($jfollow_id) { 
		my $fol = Tab::FollowJudge->retrieve($jfollow_id);
		$fol->delete;
	}

	my $msg = "Follower removed";
	$m->redirect("undo.mhtml?tourn_id=$tourn_id&msg=$msg") if $follow_id || $jfollow_id;
	$m->redirect("schools.mhtml?tourn_id=$tourn_id&msg=$msg") if $school_id;
	$m->redirect("index.mhtml?event_id=$event_id&tourn_id=$tourn_id&msg=$msg");

</%init>
